<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>General Ledger: reportsEditorSection.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>reportsEditorSection.cpp</h1><a href="reportsEditorSection_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* General Ledger, Copyright (C) 2004  Joshua Eckroth &lt;josh@eckroth.net&gt;</span>
00002 <span class="comment"> * http://www.eckroth.net/software/genledg</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
00005 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment"> * (at your option) any later version.</span>
00008 <span class="comment"> * </span>
00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment"> * GNU General Public License for more details.</span>
00013 <span class="comment"> * </span>
00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00015 <span class="comment"> * along with this program; if not, write to the Free Software</span>
00016 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  US</span>
00017 <span class="comment">*/</span>
00018 
00019 <span class="preprocessor">#include &lt;vector&gt;</span>
00020 <span class="keyword">using</span> std::vector;
00021 
00022 <span class="preprocessor">#include &lt;qwidget.h&gt;</span>
00023 <span class="preprocessor">#include &lt;qstring.h&gt;</span>
00024 <span class="preprocessor">#include &lt;qlayout.h&gt;</span>
00025 <span class="preprocessor">#include &lt;qlabel.h&gt;</span>
00026 <span class="preprocessor">#include &lt;qpushbutton.h&gt;</span>
00027 
00028 <span class="preprocessor">#include "<a class="code" href="reportsEditorSection_8h.html">reportsEditorSection.h</a>"</span>
00029 <span class="preprocessor">#include "<a class="code" href="reportsEditor_8h.html">reportsEditor.h</a>"</span>
00030 <span class="preprocessor">#include "<a class="code" href="reportsEditorDialog_8h.html">reportsEditorDialog.h</a>"</span>
00031 <span class="preprocessor">#include "<a class="code" href="reportsEditorEntityWidget_8h.html">reportsEditorEntityWidget.h</a>"</span>
00032 <span class="preprocessor">#include "config.h"</span>
00033 
<a name="l00034"></a><a class="code" href="classReportsEditorSection.html#a0">00034</a> <a class="code" href="classReportsEditorSection.html#a0">ReportsEditorSection::ReportsEditorSection</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qwidget.html">QWidget</a> *parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
00035                 <span class="keyword">const</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> newTitle, ReportsEditor::Editor newEditor,
00036                 ReportsEditor::Section newSection)
00037     : <a class="codeRef" doxygen="doxy-qt.tag:" href="qwidget.html">QWidget</a>(parent,name), title(newTitle), editor(newEditor), section(newSection)
00038 {
00039     reportsEditor = <a class="code" href="classReportsEditor.html#e0">ReportsEditor::instance</a>();
00040 
00041 
00042     vBoxLayout = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qvboxlayout.html">QVBoxLayout</a>(<span class="keyword">this</span>, 0, 5,
00043                     <span class="stringliteral">"reportsEditorSection::vBoxLayout"</span>);
00044 
00045 
00046     <a class="code" href="classReportsEditorSection.html#r6">header</a> = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qwidget.html">QWidget</a>(<span class="keyword">this</span>, <span class="stringliteral">"reportsEditorSection::header"</span>);
00047 
00048     <a class="code" href="classReportsEditorSection.html#r7">headerHBoxLayout</a> = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qhboxlayout.html">QHBoxLayout</a>(<a class="code" href="classReportsEditorSection.html#r6">header</a>, 0, -1,
00049                     <span class="stringliteral">"reportsEditorSection::headerHBoxLayout"</span>);
00050 
00051     <a class="code" href="classReportsEditorSection.html#r8">headerLabel</a> = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qlabel.html">QLabel</a>(<span class="stringliteral">"&lt;nobr&gt;&lt;b&gt;"</span> + <a class="code" href="classReportsEditorSection.html#r1">title</a> + <span class="stringliteral">"&lt;/b&gt;&lt;/nobr&gt;"</span>, <a class="code" href="classReportsEditorSection.html#r6">header</a>,
00052                     <span class="stringliteral">"reportsEditorSection::headerLabel"</span>);
00053 
00054     <a class="code" href="classReportsEditorSection.html#r9">headerButton</a> = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qpushbutton.html">QPushButton</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qiconset.html">QIconSet</a>(
00055                     QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/addEntity.png"</span>)),
00056                     <span class="stringliteral">"Add to "</span> + <a class="code" href="classReportsEditorSection.html#r1">title</a>, <a class="code" href="classReportsEditorSection.html#r6">header</a>,
00057                     <span class="stringliteral">"reportsEditorSection::headerButton"</span>);
00058     connect(<a class="code" href="classReportsEditorSection.html#r9">headerButton</a>, SIGNAL(clicked()), <span class="keyword">this</span>, SLOT(<a class="code" href="classReportsEditorSection.html#k0">addEntity</a>()));
00059 
00060     <a class="code" href="classReportsEditorSection.html#r7">headerHBoxLayout</a>-&gt;addWidget(<a class="code" href="classReportsEditorSection.html#r8">headerLabel</a>);
00061     <a class="code" href="classReportsEditorSection.html#r7">headerHBoxLayout</a>-&gt;addStretch();
00062     <a class="code" href="classReportsEditorSection.html#r7">headerHBoxLayout</a>-&gt;addWidget(<a class="code" href="classReportsEditorSection.html#r9">headerButton</a>);
00063 
00064 
00065     <a class="code" href="classReportsEditorSection.html#r10">body</a> = <span class="keyword">new</span> QWidget(<span class="keyword">this</span>, <span class="stringliteral">"reportsEditorSection::body"</span>);
00066 
00067     <a class="code" href="classReportsEditorSection.html#r11">bodyHBoxLayout</a> = <span class="keyword">new</span> QHBoxLayout(<a class="code" href="classReportsEditorSection.html#r10">body</a>, 0, -1,
00068                     <span class="stringliteral">"reportsEditorSection::bodyHBoxLayout"</span>);
00069     <a class="code" href="classReportsEditorSection.html#d0">listSection</a>();  <span class="comment">// creates list widget</span>
00070     <a class="code" href="classReportsEditorSection.html#r11">bodyHBoxLayout</a>-&gt;addSpacing(5);
00071     <a class="code" href="classReportsEditorSection.html#r11">bodyHBoxLayout</a>-&gt;addWidget(list);
00072 
00073 
00074     vBoxLayout-&gt;addWidget(<a class="code" href="classReportsEditorSection.html#r6">header</a>);
00075     vBoxLayout-&gt;addWidget(<a class="code" href="classReportsEditorSection.html#r10">body</a>);
00076 }
00077 
<a name="l00078"></a><a class="code" href="classReportsEditorSection.html#k0">00078</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditorSection.html#k0">ReportsEditorSection::addEntity</a>()
00079 {
00080     <a class="code" href="classReportsEditorDialog.html">ReportsEditorDialog</a> *dialog = <span class="keyword">new</span> <a class="code" href="classReportsEditorDialog.html">ReportsEditorDialog</a>(<span class="keyword">this</span>,
00081                     <span class="stringliteral">"reportsEditorSection::dialog"</span>, <a class="code" href="classReportsEditorSection.html#r1">title</a>);
00082 
00083     <span class="keywordflow">if</span>(dialog-&gt;exec())
00084     {
00085         <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> accountBegin = dialog-&gt;<a class="code" href="classReportsEditorDialog.html#a1">getAccountBegin</a>();
00086         <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> accountEnd = dialog-&gt;<a class="code" href="classReportsEditorDialog.html#a2">getAccountEnd</a>();
00087         <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> desc = dialog-&gt;<a class="code" href="classReportsEditorDialog.html#a3">getDesc</a>();
00088 
00089         <span class="keywordflow">if</span>(accountBegin == accountEnd)
00090             accountEnd = <span class="stringliteral">""</span>;
00091 
00092         <span class="keywordflow">if</span>(!reportsEditor-&gt;<a class="code" href="classReportsEditor.html#a8">entityExists</a>(editor, section,
00093                         accountBegin, accountEnd, desc)
00094            &amp;&amp; desc != <span class="stringliteral">""</span>)
00095         {
00096             <a class="code" href="structReportsEditor_1_1Entity.html">ReportsEditor::Entity</a> *entity = <span class="keyword">new</span> <a class="code" href="structReportsEditor_1_1Entity.html">ReportsEditor::Entity</a>;
00097             entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o0">editor</a> = editor;
00098             entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o1">section</a> = section;
00099             entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o2">index</a> = reportsEditor-&gt;<a class="code" href="classReportsEditor.html#a11">getNextIndex</a>(editor, section);
00100             entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o3">accountBegin</a> = accountBegin;
00101             entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o4">accountEnd</a> = accountEnd;
00102             entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o5">desc</a> = desc;
00103 
00104             reportsEditor-&gt;<a class="code" href="classReportsEditor.html#a14">addEntity</a>(entity);
00105 
00106             <a class="code" href="classReportsEditorSection.html#k1">update</a>();
00107         }
00108     }
00109 
00110     <span class="keyword">delete</span> dialog;
00111 }
00112 
<a name="l00113"></a><a class="code" href="classReportsEditorSection.html#k1">00113</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditorSection.html#k1">ReportsEditorSection::update</a>()
00114 {
00115     <span class="keyword">delete</span> list;
00116     <a class="code" href="classReportsEditorSection.html#d0">listSection</a>();
00117 
00118     <a class="code" href="classReportsEditorSection.html#r11">bodyHBoxLayout</a>-&gt;addWidget(list);
00119     list-&gt;show();
00120 }
00121 
<a name="l00122"></a><a class="code" href="classReportsEditorSection.html#d0">00122</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditorSection.html#d0">ReportsEditorSection::listSection</a>()
00123 {
00124     vector&lt;ReportsEditor::Entity*&gt; entities = reportsEditor-&gt;<a class="code" href="classReportsEditor.html#a7">getEntities</a>(editor, section);
00125 
00126     <span class="keywordflow">if</span>(entities.size() == 0)
00127     {
00128         <a class="code" href="classReportsEditorSection.html#r4">numOfEntities</a> = 0;
00129         list = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qlabel.html">QLabel</a>(<span class="stringliteral">"No Entries"</span>, <a class="code" href="classReportsEditorSection.html#r10">body</a>, <span class="stringliteral">"reportsEditorSection::list"</span>);
00130     }
00131     <span class="keywordflow">else</span>
00132     {
00133         list = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qwidget.html">QWidget</a>(<a class="code" href="classReportsEditorSection.html#r10">body</a>, <span class="stringliteral">"reportsEditorSection::list"</span>);
00134         <a class="code" href="classReportsEditorSection.html#r13">listVBoxLayout</a> = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qvboxlayout.html">QVBoxLayout</a>(list, 0, 5, <span class="stringliteral">"reportsEditorSection::listVBoxLayout"</span>);
00135         
00136         <span class="keywordflow">for</span>(vector&lt;ReportsEditor::Entity*&gt;::const_iterator it = entities.begin();
00137                         it != entities.end(); ++it)
00138         {
00139             <a class="code" href="classReportsEditorEntityWidget.html">ReportsEditorEntityWidget</a> *entityWidget = <span class="keyword">new</span> <a class="code" href="classReportsEditorEntityWidget.html">ReportsEditorEntityWidget</a>(
00140                             list, <span class="stringliteral">"reportsEditorSection::entityWidget"</span>, *it);
00141             connect(entityWidget, SIGNAL(changed()), <span class="keyword">this</span>, SLOT(<a class="code" href="classReportsEditorSection.html#k1">update</a>()));
00142 
00143             <a class="code" href="classReportsEditorSection.html#r13">listVBoxLayout</a>-&gt;addWidget(entityWidget);
00144         }
00145     }
00146 }
00147 
00148 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Jan 16 16:23:28 2005 for General Ledger by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
