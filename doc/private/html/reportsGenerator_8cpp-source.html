<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>General Ledger: reportsGenerator.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>reportsGenerator.cpp</h1><a href="reportsGenerator_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* General Ledger, Copyright (C) 2004  Joshua Eckroth &lt;josh@eckroth.net&gt;</span>
00002 <span class="comment"> * http://www.eckroth.net/software/genledg</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
00005 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment"> * (at your option) any later version.</span>
00008 <span class="comment"> * </span>
00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment"> * GNU General Public License for more details.</span>
00013 <span class="comment"> * </span>
00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00015 <span class="comment"> * along with this program; if not, write to the Free Software</span>
00016 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  US</span>
00017 <span class="comment">*/</span>
00018 
00019 <span class="preprocessor">#include &lt;vector&gt;</span>
00020 <span class="keyword">using</span> std::vector;
00021 
00022 <span class="preprocessor">#include &lt;cmath&gt;</span>
00023 <span class="keyword">using</span> std::abs;
00024 
00025 <span class="preprocessor">#include &lt;qstring.h&gt;</span>
00026 <span class="preprocessor">#include &lt;qdatetime.h&gt;</span>
00027 
00028 <span class="preprocessor">#include "<a class="code" href="reportsGenerator_8h.html">reportsGenerator.h</a>"</span>
00029 <span class="preprocessor">#include "<a class="code" href="reportsEditor_8h.html">reportsEditor.h</a>"</span>
00030 <span class="preprocessor">#include "<a class="code" href="reportsPrint_8h.html">reportsPrint.h</a>"</span>
00031 <span class="preprocessor">#include "<a class="code" href="client_8h.html">client.h</a>"</span>
00032 <span class="preprocessor">#include "<a class="code" href="accountsData_8h.html">accountsData.h</a>"</span>
00033 <span class="preprocessor">#include "<a class="code" href="journalData_8h.html">journalData.h</a>"</span>
00034 <span class="preprocessor">#include "<a class="code" href="main_8h.html">main.h</a>"</span>
00035 
<a name="l00036"></a><a class="code" href="classReportsGenerator.html#v0">00036</a> <a class="code" href="classReportsGenerator.html">ReportsGenerator</a>* <a class="code" href="classReportsGenerator.html#v0">ReportsGenerator::thisInstance</a> = 0;
00037 
<a name="l00038"></a><a class="code" href="classReportsGenerator.html#e0">00038</a> <a class="code" href="classReportsGenerator.html">ReportsGenerator</a>* <a class="code" href="classReportsGenerator.html#e0">ReportsGenerator::instance</a>()
00039 {
00040     <span class="keywordflow">if</span>(<a class="code" href="classReportsGenerator.html#v0">thisInstance</a> == 0)
00041         <a class="code" href="classReportsGenerator.html#v0">thisInstance</a> = <span class="keyword">new</span> <a class="code" href="classReportsGenerator.html">ReportsGenerator</a>;
00042     <span class="keywordflow">return</span> <a class="code" href="classReportsGenerator.html#v0">thisInstance</a>;
00043 }
00044 
<a name="l00045"></a><a class="code" href="classReportsGenerator.html#a0">00045</a> <span class="keywordtype">void</span> <a class="code" href="classReportsGenerator.html#a0">ReportsGenerator::destroy</a>()
00046 {
00047     <span class="keywordflow">if</span>(<a class="code" href="classReportsGenerator.html#v0">thisInstance</a> != 0)
00048         <span class="keyword">delete</span> <a class="code" href="classReportsGenerator.html#v0">thisInstance</a>;
00049 }
00050 
<a name="l00051"></a><a class="code" href="classReportsGenerator.html#a1">00051</a> <span class="keywordtype">void</span> <a class="code" href="classReportsGenerator.html#a1">ReportsGenerator::genGeneralDetailReport</a>(
00052                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a> periodBegin, <a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a> periodEnd,
00053                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> accountBegin, <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> accountEnd)
00054 {
00055     <a class="code" href="classReportsGenerator.html#a11">setDocName</a>(<span class="stringliteral">"General Ledger Detail"</span>);
00056     <a class="code" href="classReportsGenerator.html#r7">csv</a> = <span class="stringliteral">"\"Account ID\",\"Account Description\",\"Date\",\"Reference\","</span>
00057           <span class="stringliteral">"\"Description\",\"Debit Amt\",\"Credit Amt\",\"Balance\"\n"</span>;
00058     header = <span class="stringliteral">"&lt;html&gt;&lt;body&gt;&lt;center&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00059          <span class="stringliteral">" - General Ledger Detail&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;"</span>;
00060     <a class="code" href="classReportsGenerator.html#r6">html</a> = <span class="stringliteral">"&lt;html&gt;&lt;head&gt;&lt;title&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00061        <span class="stringliteral">"&lt;/title&gt;&lt;/head&gt;&lt;body&gt;\n"</span>
00062            <span class="stringliteral">"&lt;center&gt;&lt;h1&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() + <span class="stringliteral">"&lt;/h1&gt;&lt;/center&gt;\n"</span>
00063            <span class="stringliteral">"&lt;center&gt;&lt;h2&gt;General Ledger Detail&lt;/h2&gt;&lt;/center&gt;\n"</span>
00064            <span class="stringliteral">"&lt;center&gt;&lt;h3&gt;For the Period From "</span> +
00065        periodBegin.toString(<span class="stringliteral">"MMM d, yyyy"</span>) +
00066            <span class="stringliteral">" to "</span> + periodEnd.toString(<span class="stringliteral">"MMM d, yyyy"</span>) + <span class="stringliteral">"&lt;/h3&gt;&lt;/center&gt;\n"</span>;
00067     <span class="keywordflow">if</span>(accountBegin == <span class="stringliteral">""</span> &amp;&amp; accountEnd == <span class="stringliteral">""</span>)
00068     {
00069         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;center&gt;&lt;h4&gt;All Accounts&lt;/h4&gt;&lt;/center&gt;\n"</span>;
00070     }
00071     <span class="keywordflow">else</span>
00072     {
00073         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;center&gt;&lt;h4&gt;Account Range: "</span> + accountBegin +
00074                 <span class="stringliteral">" to "</span> + accountEnd + <span class="stringliteral">"&lt;/h4&gt;&lt;/center&gt;\n"</span>;
00075     }
00076 
00077     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;table width=\"100%\"&gt;&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;\n"</span>
00078             <span class="stringliteral">"&lt;td width=\"19%\"&gt;&lt;b&gt;Account ID&lt;br&gt;Account Description&lt;/b&gt;&lt;/td&gt;\n"</span>
00079             <span class="stringliteral">"&lt;td width=\"10%\"&gt;&lt;b&gt;Date&lt;/b&gt;&lt;/td&gt;\n"</span>
00080             <span class="stringliteral">"&lt;td width=\"10%\"&gt;&lt;b&gt;Reference&lt;/b&gt;&lt;/td&gt;\n"</span>
00081             <span class="stringliteral">"&lt;td width=\"31%\"&gt;&lt;b&gt;Description&lt;/b&gt;&lt;/td&gt;\n"</span>
00082             <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;&lt;b&gt;Debit Amt&lt;/b&gt;&lt;/td&gt;\n"</span>
00083             <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;&lt;b&gt;Credit Amt&lt;/b&gt;&lt;/td&gt;\n"</span>
00084             <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;&lt;b&gt;Balance&lt;/b&gt;&lt;/td&gt;\n"</span>
00085             <span class="stringliteral">"&lt;/tr&gt;\n"</span>;
00086 
00087     <span class="comment">// Get all the accounts we need, sorted, with REAccount added</span>
00088     vector&lt;AccountsData::Account*&gt; accounts = accountsData-&gt;<a class="code" href="classAccountsData.html#a5">getAccounts</a>(
00089                     accountBegin, accountEnd, <span class="keyword">true</span>, <span class="keyword">true</span>);
00090 
00091     Q_INT64 beginningBalance;
00092     Q_INT64 debitBalance;
00093     Q_INT64 creditBalance;
00094 
00095     <span class="keywordtype">bool</span> accountDisplayed;
00096 
00097     <span class="comment">// Prepare the journal records container</span>
00098     vector&lt;JournalData::JournalRecord*&gt; journalRecords;
00099 
00100     <span class="comment">// Look at every account</span>
00101     <span class="keywordflow">for</span>(vector&lt;AccountsData::Account*&gt;::const_iterator accountIt =
00102     accounts.begin(); accountIt != accounts.end(); ++accountIt)
00103     {
00104         accountDisplayed = <span class="keyword">false</span>;
00105 
00106         beginningBalance = 0;
00107         debitBalance = 0;
00108         creditBalance = 0;
00109 
00110         <span class="comment">// Get the journal entries prior to our periodBegin date</span>
00111         <span class="comment">// to compute the Beginning Balance column</span>
00112         journalRecords = journalData-&gt;<a class="code" href="classJournalData.html#a6">getJournalRecords</a>(
00113             (*accountIt)-&gt;id, (*accountIt)-&gt;id,
00114             <a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a>(), periodBegin.addDays(-1));
00115 
00116         <span class="keywordflow">for</span>(vector&lt;JournalData::JournalRecord*&gt;::const_iterator journalIt =
00117         journalRecords.begin(); journalIt != journalRecords.end();
00118             ++journalIt)
00119         {
00120             beginningBalance += (*journalIt)-&gt;amount;
00121         }
00122 
00123         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"19%\"&gt;"</span> + (*accountIt)-&gt;id + <span class="stringliteral">"&lt;/td&gt;"</span>
00124                 <span class="stringliteral">"&lt;td width=\"10%\"&gt;"</span> + periodBegin.toString(<span class="stringliteral">"MM/dd/yyyy"</span>) + <span class="stringliteral">"&lt;/td&gt;"</span>
00125                 <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>
00126                 <span class="stringliteral">"&lt;td width=\"31%\"&gt;Beginning Balance&lt;/td&gt;"</span>
00127                 <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>
00128                 <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>;
00129 
00130         <span class="keywordflow">if</span>(beginningBalance == 0)
00131             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>;
00132         <span class="keywordflow">else</span>
00133             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;"</span> +
00134                     <a class="code" href="main_8h.html#a0">formatCurrency</a>(beginningBalance) + <span class="stringliteral">"&lt;/td&gt;"</span>;
00135 
00136         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/tr&gt;\n"</span>;
00137 
00138         <a class="code" href="classReportsGenerator.html#r7">csv</a> += (*accountIt)-&gt;id + <span class="stringliteral">",\""</span> + (*accountIt)-&gt;desc + <span class="stringliteral">"\","</span> +
00139                periodBegin.toString(Qt::ISODate) + <span class="stringliteral">",,\"Beginning Balance\",,,"</span> +
00140                <a class="code" href="main_8h.html#a0">formatCurrency</a>(beginningBalance, <span class="keyword">false</span>) + <span class="stringliteral">"\n"</span>;
00141 
00142         <span class="comment">// Get the journal records for this account, with max and min dates,</span>
00143         <span class="comment">// sorted by date</span>
00144         journalRecords = journalData-&gt;<a class="code" href="classJournalData.html#a6">getJournalRecords</a>(
00145                         (*accountIt)-&gt;id, (*accountIt)-&gt;id,
00146                         periodBegin, periodEnd, JournalData::SortDate);
00147 
00148         <span class="comment">// Look at every journal record</span>
00149         <span class="keywordflow">for</span>(vector&lt;JournalData::JournalRecord*&gt;::const_iterator journalIt =
00150             journalRecords.begin(); journalIt != journalRecords.end();
00151             ++journalIt)
00152         {
00153             <span class="keywordflow">if</span>((*journalIt)-&gt;amount &lt; 0)
00154                 creditBalance += abs((*journalIt)-&gt;amount);
00155             <span class="keywordflow">else</span>
00156                 debitBalance += (*journalIt)-&gt;amount;
00157 
00158 
00159             <span class="keywordflow">if</span>(!accountDisplayed)
00160             {
00161                 <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"19%\"&gt;"</span> + (*accountIt)-&gt;desc + <span class="stringliteral">"&lt;/td&gt;"</span>;
00162                 accountDisplayed = <span class="keyword">true</span>;
00163             }
00164             <span class="keywordflow">else</span>
00165             {
00166                 <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"19%\"&gt; &lt;/td&gt;"</span>;
00167             }
00168 
00169             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td width=\"10%\"&gt;"</span> +
00170                     ((*journalIt)-&gt;date).toString(<span class="stringliteral">"MM/dd/yyyy"</span>) + <span class="stringliteral">"&lt;/td&gt;"</span>
00171                     <span class="stringliteral">"&lt;td width=\"10%\"&gt;"</span> + (*journalIt)-&gt;reference + <span class="stringliteral">"&lt;/td&gt;"</span>
00172                     <span class="stringliteral">"&lt;td width=\"31%\"&gt;"</span> + (*journalIt)-&gt;desc + <span class="stringliteral">"&lt;/td&gt;"</span>;
00173 
00174             <a class="code" href="classReportsGenerator.html#r7">csv</a> += (*accountIt)-&gt;id + <span class="stringliteral">",\""</span> + (*accountIt)-&gt;desc + <span class="stringliteral">"\","</span> +
00175                    ((*journalIt)-&gt;date).toString(Qt::ISODate) + <span class="stringliteral">","</span> +
00176                    <span class="stringliteral">"\""</span> + (*journalIt)-&gt;reference + <span class="stringliteral">"\","</span> +
00177                    <span class="stringliteral">"\""</span> + (*journalIt)-&gt;desc + <span class="stringliteral">"\","</span>;
00178 
00179             <span class="keywordflow">if</span>((*journalIt)-&gt;amount &gt; 0)
00180             {
00181                 <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;"</span> +
00182                         <a class="code" href="main_8h.html#a0">formatCurrency</a>((*journalIt)-&gt;amount) +
00183                         <span class="stringliteral">"&lt;/td&gt;&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>;
00184 
00185                 <a class="code" href="classReportsGenerator.html#r7">csv</a> += <a class="code" href="main_8h.html#a0">formatCurrency</a>((*journalIt)-&gt;amount, <span class="keyword">false</span>);
00186             }
00187             <span class="keywordflow">else</span>
00188             {
00189                 <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;&lt;td align=\"right\" "</span>
00190                         <span class="stringliteral">"width=\"10%\"&gt;"</span> +
00191                         <a class="code" href="main_8h.html#a0">formatCurrency</a>(abs((*journalIt)-&gt;amount)) + <span class="stringliteral">"&lt;/td&gt;"</span>;
00192 
00193                 <a class="code" href="classReportsGenerator.html#r7">csv</a> += <a class="code" href="main_8h.html#a0">formatCurrency</a>((*journalIt)-&gt;amount, <span class="keyword">false</span>);
00194             }
00195 
00196             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">",\n"</span>;
00197         }
00198 
00199         <span class="keywordflow">if</span>(debitBalance != 0 || creditBalance != 0)
00200         {
00201             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/tr&gt;\n"</span>
00202                     <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"19%\"&gt; &lt;/td&gt;"</span>
00203                     <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>
00204                     <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>
00205                     <span class="stringliteral">"&lt;td width=\"31%\"&gt;Current Period Change&lt;/td&gt;"</span>;
00206             
00207             <span class="keywordflow">if</span>(debitBalance == 0)
00208                 <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>;
00209             <span class="keywordflow">else</span>
00210                 <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;"</span> +
00211                         <a class="code" href="main_8h.html#a0">formatCurrency</a>(debitBalance) + <span class="stringliteral">"&lt;/td&gt;"</span>;
00212 
00213             <span class="keywordflow">if</span>(creditBalance == 0)
00214                 <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>;
00215             <span class="keywordflow">else</span>
00216                 <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;"</span> +
00217                         <a class="code" href="main_8h.html#a0">formatCurrency</a>(creditBalance) + <span class="stringliteral">"&lt;/td&gt;"</span>;
00218 
00219             <span class="keywordflow">if</span>(creditBalance == 0 &amp;&amp; debitBalance == 0)
00220             {
00221                 <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>;
00222             }
00223             <span class="keywordflow">else</span>
00224             {
00225                 <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;"</span> +
00226                         <a class="code" href="main_8h.html#a0">formatCurrency</a>(debitBalance - creditBalance) + <span class="stringliteral">"&lt;/td&gt;"</span>;
00227             }
00228 
00229             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">",,,,\"Current Period Change\","</span> +
00230                    <a class="code" href="main_8h.html#a0">formatCurrency</a>(debitBalance, <span class="keyword">false</span>) + <span class="stringliteral">","</span> +
00231                    <a class="code" href="main_8h.html#a0">formatCurrency</a>(creditBalance, <span class="keyword">false</span>) + <span class="stringliteral">","</span> +
00232                    <a class="code" href="main_8h.html#a0">formatCurrency</a>(debitBalance - creditBalance, <span class="keyword">false</span>) + <span class="stringliteral">"\n"</span>;
00233         }
00234 
00235         <span class="keywordflow">if</span>(!accountDisplayed)
00236             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"19%\"&gt;"</span> + (*accountIt)-&gt;desc +
00237                     <span class="stringliteral">"&lt;/td&gt;&lt;/tr&gt;\n"</span>;
00238 
00239         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"19%\"&gt; &lt;/td&gt;"</span>
00240                 <span class="stringliteral">"&lt;td width=\"10%\"&gt;&lt;b&gt;"</span> + periodEnd.toString(<span class="stringliteral">"MM/dd/yyyy"</span>) +
00241                 <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;"</span>
00242                 <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>
00243                 <span class="stringliteral">"&lt;td width=\"31%\"&gt;&lt;b&gt;Ending Balance&lt;/b&gt;&lt;/td&gt;"</span>
00244                 <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>
00245                 <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>;
00246 
00247         <span class="keywordflow">if</span>(beginningBalance == 0 &amp;&amp; debitBalance == 0 &amp;&amp; creditBalance == 0)
00248         {
00249             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>;
00250         }
00251         <span class="keywordflow">else</span>
00252         {
00253             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;&lt;b&gt;"</span> +
00254                     <a class="code" href="main_8h.html#a0">formatCurrency</a>(beginningBalance + debitBalance
00255                                     - creditBalance) + <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;"</span>;
00256         }
00257 
00258         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/tr&gt;&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;\n"</span>;
00259 
00260         <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">",,"</span> + periodEnd.toString(Qt::ISODate) +
00261                <span class="stringliteral">",,\"Ending Balance\",,,"</span> +
00262                <a class="code" href="main_8h.html#a0">formatCurrency</a>(beginningBalance + debitBalance 
00263                                - creditBalance, <span class="keyword">false</span>) + <span class="stringliteral">"\n"</span>;
00264     }
00265 
00266     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;"</span>;
00267 }
00268 
<a name="l00269"></a><a class="code" href="classReportsGenerator.html#a2">00269</a> <span class="keywordtype">void</span> <a class="code" href="classReportsGenerator.html#a2">ReportsGenerator::genGeneralTrialReport</a>(
00270                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a> periodEnd, <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> accountBegin, <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> accountEnd)
00271 {
00272     <a class="code" href="classReportsGenerator.html#a11">setDocName</a>(<span class="stringliteral">"General Ledger Trial Balance"</span>);
00273     <a class="code" href="classReportsGenerator.html#r7">csv</a> = <span class="stringliteral">"\"Account Id\",\"Account Description\",\"Debit Amt\","</span>
00274           <span class="stringliteral">"\"Credit Amt\"\n"</span>;
00275     header = <span class="stringliteral">"&lt;html&gt;&lt;body&gt;&lt;center&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00276          <span class="stringliteral">" - General Ledger Trial Balance&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;"</span>;
00277     <a class="code" href="classReportsGenerator.html#r6">html</a> = <span class="stringliteral">"&lt;html&gt;&lt;head&gt;&lt;title&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00278            <span class="stringliteral">"&lt;/title&gt;&lt;/head&gt;&lt;body&gt;\n"</span>
00279            <span class="stringliteral">"&lt;center&gt;&lt;h1&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() + <span class="stringliteral">"&lt;/h1&gt;&lt;/center&gt;\n"</span>
00280            <span class="stringliteral">"&lt;center&gt;&lt;h2&gt;General Ledger Trial Balance&lt;/h2&gt;&lt;/center&gt;\n"</span>
00281            <span class="stringliteral">"&lt;center&gt;&lt;h3&gt;As of "</span> + periodEnd.toString(<span class="stringliteral">"MMM d, yyyy"</span>) +
00282            <span class="stringliteral">"&lt;/h3&gt;&lt;/center&gt;\n"</span>;
00283     <span class="keywordflow">if</span>(accountBegin == <span class="stringliteral">""</span> || accountEnd == <span class="stringliteral">""</span>)
00284     {
00285         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;center&gt;&lt;h4&gt;All Accounts&lt;/h4&gt;&lt;/center&gt;\n"</span>;
00286     }
00287     <span class="keywordflow">else</span>
00288     {
00289         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;center&gt;&lt;h4&gt;Account Range: "</span> + accountBegin + <span class="stringliteral">" to "</span>
00290                 + accountEnd +
00291                 <span class="stringliteral">"&lt;/h4&gt;&lt;/center&gt;\n"</span>;
00292     }
00293     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;table width=\"100%\"&gt;&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td width=\"19%\"&gt;"</span>
00294             <span class="stringliteral">"&lt;b&gt;Account ID&lt;/b&gt;&lt;/td&gt;\n"</span>
00295             <span class="stringliteral">"&lt;td width=\"31%\"&gt;&lt;b&gt;Account Description&lt;/b&gt;&lt;/td&gt;\n"</span>
00296             <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;&lt;b&gt;Debit Amt&lt;/b&gt;&lt;/td&gt;\n"</span>
00297             <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;&lt;b&gt;Credit Amt&lt;/b&gt;&lt;/td&gt;\n"</span>
00298             <span class="stringliteral">"&lt;td width=\"30%\"&gt; &lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;\n"</span>
00299             <span class="stringliteral">"&lt;table width=\"100%\"&gt;\n"</span>;
00300 
00301     <span class="comment">// Get all the accounts we need, sorted, with REAccount added</span>
00302     vector&lt;AccountsData::Account*&gt; accounts = accountsData-&gt;<a class="code" href="classAccountsData.html#a5">getAccounts</a>(
00303                     accountBegin, accountEnd, <span class="keyword">true</span>, <span class="keyword">true</span>);
00304 
00305     <span class="comment">// Prepare our running totals</span>
00306     Q_INT64 accountBalance;
00307     Q_INT64 totalDebit = 0;
00308     Q_INT64 totalCredit = 0;
00309 
00310     <span class="comment">// Prepare the journal records container</span>
00311     vector&lt;JournalData::JournalRecord*&gt; journalRecords;
00312 
00313     <span class="comment">// Look at every account</span>
00314     <span class="keywordflow">for</span>(vector&lt;AccountsData::Account*&gt;::const_iterator accountIt =
00315         accounts.begin(); accountIt != accounts.end(); ++accountIt)
00316     {
00317         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"19%\"&gt;"</span> + (*accountIt)-&gt;id + <span class="stringliteral">"&lt;/td&gt;"</span>
00318                 <span class="stringliteral">"&lt;td width=\"31%\"&gt;"</span> + (*accountIt)-&gt;desc + <span class="stringliteral">"&lt;/td&gt;"</span>;
00319 
00320         <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">"\""</span> + (*accountIt)-&gt;id + <span class="stringliteral">"\","</span> +
00321                <span class="stringliteral">"\""</span> + (*accountIt)-&gt;desc + <span class="stringliteral">"\","</span>;
00322 
00323         <span class="comment">// Initialize our account balance</span>
00324         accountBalance = 0;
00325 
00326         <span class="comment">// Get the journal records for this account, with a max date</span>
00327         journalRecords = journalData-&gt;<a class="code" href="classJournalData.html#a6">getJournalRecords</a>(
00328             (*accountIt)-&gt;id, (*accountIt)-&gt;id, <a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a>(), periodEnd);
00329 
00330         <span class="comment">// Look at every journal record</span>
00331         <span class="keywordflow">for</span>(vector&lt;JournalData::JournalRecord*&gt;::const_iterator journalIt =
00332             journalRecords.begin(); journalIt != journalRecords.end();
00333             ++journalIt)
00334         {
00335             <span class="comment">// Update our account balance</span>
00336             accountBalance += (*journalIt)-&gt;amount;
00337         }
00338 
00339         <span class="comment">// Update our total balances</span>
00340         <span class="keywordflow">if</span>(accountBalance &gt; 0)
00341             totalDebit += accountBalance;
00342         <span class="keywordflow">else</span>
00343             totalCredit += accountBalance;
00344 
00345         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;"</span>;
00346         <span class="keywordflow">if</span>(accountBalance &gt; 0)
00347         {
00348             <a class="code" href="classReportsGenerator.html#r6">html</a> += <a class="code" href="main_8h.html#a0">formatCurrency</a>(abs(accountBalance));
00349             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <a class="code" href="main_8h.html#a0">formatCurrency</a>(abs(accountBalance), <span class="keyword">false</span>) + <span class="stringliteral">","</span>;
00350         }
00351         <span class="keywordflow">else</span>
00352         {
00353             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">"0,"</span>;
00354         }
00355         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/td&gt;&lt;td align=\"right\" width=\"10%\"&gt;"</span>;
00356         <span class="keywordflow">if</span>(accountBalance &lt; 0)
00357         {
00358             <a class="code" href="classReportsGenerator.html#r6">html</a> += <a class="code" href="main_8h.html#a0">formatCurrency</a>(accountBalance);
00359             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <a class="code" href="main_8h.html#a0">formatCurrency</a>(accountBalance, <span class="keyword">false</span>) + <span class="stringliteral">"\n"</span>;
00360         }
00361         <span class="keywordflow">else</span>
00362         {
00363             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">"0\n"</span>;
00364         }
00365         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/td&gt;&lt;td width=\"30%\"&gt; &lt;/td&gt;&lt;/tr&gt;\n"</span>;
00366     }
00367 
00368     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt; &lt;/td&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;\n"</span>
00369             <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"19%\"&gt; &lt;/td&gt;&lt;td width=\"31%\"&gt;&lt;b&gt;Total&lt;/b&gt;&lt;/td&gt;\n"</span>
00370             <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;&lt;b&gt;"</span> +
00371             <a class="code" href="main_8h.html#a0">formatCurrency</a>(abs(totalDebit)) +
00372             <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;&lt;td align=\"right\" width=\"10%\"&gt;&lt;b&gt;"</span> +
00373             <a class="code" href="main_8h.html#a0">formatCurrency</a>(totalCredit) +
00374             <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;&lt;td width=\"30%\"&gt; &lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;\n"</span>;
00375 
00376     <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">",\"Total\","</span> + <a class="code" href="main_8h.html#a0">formatCurrency</a>(abs(totalDebit), <span class="keyword">false</span>) + <span class="stringliteral">","</span> +
00377            <a class="code" href="main_8h.html#a0">formatCurrency</a>(totalCredit, <span class="keyword">false</span>) + <span class="stringliteral">"\n"</span>;
00378 }
00379 
<a name="l00380"></a><a class="code" href="classReportsGenerator.html#a3">00380</a> <span class="keywordtype">void</span> <a class="code" href="classReportsGenerator.html#a3">ReportsGenerator::genBalanceSheetReport</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a> periodEnd)
00381 {
00382     <a class="code" href="classReportsGenerator.html#a11">setDocName</a>(<span class="stringliteral">"Balance Sheet"</span>);
00383     <a class="code" href="classReportsGenerator.html#r7">csv</a> = <span class="stringliteral">"\"Account Description\",\"Balance\"\n"</span>;
00384     header = <span class="stringliteral">"&lt;html&gt;&lt;body&gt;&lt;center&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00385          <span class="stringliteral">" - Balance Sheet&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;"</span>;
00386     <a class="code" href="classReportsGenerator.html#r6">html</a> = <span class="stringliteral">"&lt;html&gt;&lt;head&gt;&lt;title&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00387            <span class="stringliteral">" - Balance Sheet&lt;/title&gt;&lt;/head&gt;&lt;body&gt;\n"</span>
00388            <span class="stringliteral">"&lt;center&gt;&lt;h1&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() + <span class="stringliteral">"&lt;/h1&gt;&lt;/center&gt;\n"</span>
00389            <span class="stringliteral">"&lt;center&gt;&lt;h2&gt;Balance Sheet&lt;/h2&gt;&lt;/center&gt;\n"</span>
00390            <span class="stringliteral">"&lt;center&gt;&lt;h3&gt;"</span> + periodEnd.toString(<span class="stringliteral">"MMM d, yyyy"</span>) +
00391            <span class="stringliteral">"&lt;/h3&gt;&lt;/center&gt;\n"</span>
00392            <span class="stringliteral">"&lt;center&gt;&lt;table width=\"60%\"&gt;&lt;tr&gt;"</span>
00393            <span class="stringliteral">"&lt;td width=\"70%\"&gt;&lt;b&gt;Account Description&lt;/b&gt;&lt;/td&gt;"</span>
00394            <span class="stringliteral">"&lt;td align=\"right\" width=\"30%\"&gt;&lt;b&gt;Balance&lt;/b&gt;&lt;/td&gt;"</span>
00395            <span class="stringliteral">"&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;\n"</span>
00396            <span class="stringliteral">"&lt;center&gt;&lt;table width=\"60%\"&gt;\n"</span>;
00397 
00398     vector&lt;ReportsEditor::Section&gt; sections;
00399     sections.push_back(ReportsEditor::Assets);
00400     sections.push_back(ReportsEditor::Liabilities);
00401     sections.push_back(ReportsEditor::Equities);
00402 
00403     Q_INT64 accountBalance;
00404     Q_INT64 sectionBalance;
00405 
00406     <span class="keywordflow">for</span>(vector&lt;ReportsEditor::Section&gt;::const_iterator sectionIt =
00407         sections.begin(); sectionIt != sections.end(); ++sectionIt)
00408     {
00409     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td colspan=\"2\"&gt;&lt;center&gt;&lt;b&gt;"</span>;
00410     <span class="keywordflow">if</span>((*sectionIt) == ReportsEditor::Assets)
00411     {
00412         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"Assets"</span>;
00413     }
00414     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((*sectionIt) == ReportsEditor::Liabilities)
00415     {
00416         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"Liabilities"</span>;
00417     }
00418     <span class="keywordflow">else</span> <span class="keywordflow">if</span>((*sectionIt) == ReportsEditor::Equities)
00419     {
00420         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"Equities"</span>;
00421     }
00422     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;\n"</span>;
00423     
00424         sectionBalance = 0;
00425 
00426         vector&lt;ReportsEditor::Entity*&gt; entities = 
00427             reportsEditor-&gt;<a class="code" href="classReportsEditor.html#a7">getEntities</a>(ReportsEditor::BalanceSheet, *sectionIt);
00428 
00429         <span class="keywordflow">for</span>(vector&lt;ReportsEditor::Entity*&gt;::const_iterator entityIt =
00430             entities.begin(); entityIt != entities.end(); ++entityIt)
00431         {
00432             accountBalance = 0;
00433 
00434             vector&lt;JournalData::JournalRecord*&gt; records =
00435                 journalData-&gt;<a class="code" href="classJournalData.html#a6">getJournalRecords</a>((*entityIt)-&gt;accountBegin,
00436                     (*entityIt)-&gt;accountEnd, <a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a>(), periodEnd);
00437 
00438             <span class="keywordflow">for</span>(vector&lt;JournalData::JournalRecord*&gt;::const_iterator recordIt =
00439                 records.begin(); recordIt != records.end(); ++recordIt)
00440             {
00441                 accountBalance += (*recordIt)-&gt;amount;
00442             }
00443 
00444             sectionBalance += accountBalance;
00445 
00446             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"70%\"&gt;"</span> + (*entityIt)-&gt;desc + <span class="stringliteral">"&lt;/td&gt;"</span>
00447                     <span class="stringliteral">"&lt;td align=\"right\" width=\"30%\"&gt;"</span> +
00448                     <a class="code" href="main_8h.html#a0">formatCurrency</a>(accountBalance) + <span class="stringliteral">"&lt;/td&gt;&lt;/tr&gt;\n"</span>;
00449 
00450             <a class="code" href="classReportsGenerator.html#r7">csv</a> += (*entityIt)-&gt;desc + <span class="stringliteral">","</span> +
00451                    <a class="code" href="main_8h.html#a0">formatCurrency</a>(accountBalance, <span class="keyword">false</span>) + <span class="stringliteral">"\n"</span>;
00452         }
00453 
00454         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;\n"</span>
00455                 <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"70%\"&gt;&lt;b&gt;"</span>;
00456         <span class="keywordflow">if</span>((*sectionIt) == ReportsEditor::Assets)
00457         {
00458             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"Total Assets"</span>;
00459             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">"\"Total Assets\""</span>;
00460         }
00461         <span class="keywordflow">else</span> <span class="keywordflow">if</span>((*sectionIt) == ReportsEditor::Liabilities)
00462         {
00463             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"Total Liabilities"</span>;
00464             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">"\"Total Liabilities\""</span>;
00465         }
00466         <span class="keywordflow">else</span> <span class="keywordflow">if</span>((*sectionIt) == ReportsEditor::Equities)
00467         {
00468             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"Total Equities"</span>;
00469             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">"\"Total Equities\""</span>;
00470         }
00471 
00472         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;&lt;td align=\"right\" width=\"30%\"&gt;&lt;b&gt;"</span> + 
00473                 <a class="code" href="main_8h.html#a0">formatCurrency</a>(sectionBalance) + <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;"</span>
00474                 <span class="stringliteral">"&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;\n"</span>;
00475 
00476         <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">","</span> + <a class="code" href="main_8h.html#a0">formatCurrency</a>(sectionBalance, <span class="keyword">false</span>) + <span class="stringliteral">"\n"</span>;
00477     } 
00478 
00479     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;\n"</span>;
00480 }
00481 
<a name="l00482"></a><a class="code" href="classReportsGenerator.html#a4">00482</a> <span class="keywordtype">void</span> <a class="code" href="classReportsGenerator.html#a4">ReportsGenerator::genIncomeSvcReport</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a> periodEnd)
00483 {
00484     <a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a> rangeBegin = client-&gt;<a class="code" href="classClient.html#a12">getPeriodDate</a>(1, <span class="keyword">false</span>);
00485     <a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a> monthBegin = periodEnd.addMonths(-1).addDays(1);
00486 
00487     <span class="keywordtype">int</span> monthRangeInt = periodEnd.month() - rangeBegin.month();
00488     <span class="keywordflow">if</span>(monthRangeInt &lt; 0)
00489         monthRangeInt += 12;
00490     ++monthRangeInt;
00491 
00492     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> monthRange = <a class="code" href="classReportsGenerator.html#d1">numberToString</a>(monthRangeInt);
00493 
00494     <a class="code" href="classReportsGenerator.html#r7">csv</a> = <span class="stringliteral">"\"Account Description\",\"One Month Balance\","</span>;
00495     <span class="keywordflow">if</span>(monthRangeInt == 1)
00496         <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">"\"One Month Balance\"\n"</span>;
00497     <span class="keywordflow">else</span>
00498         <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">"\""</span> + monthRange + <span class="stringliteral">" Month's Balance\"\n"</span>;
00499 
00500     <a class="code" href="classReportsGenerator.html#r6">html</a> = <span class="stringliteral">"&lt;html&gt;&lt;head&gt;&lt;title&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00501            <span class="stringliteral">" - Income Statement Service Company&lt;/title&gt;&lt;/head&gt;&lt;/body&gt;\n"</span>
00502            <span class="stringliteral">"&lt;center&gt;&lt;h1&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() + <span class="stringliteral">"&lt;/center&gt;&lt;/h1&gt;\n"</span>
00503            <span class="stringliteral">"&lt;center&gt;&lt;h2&gt;Income Statement Service Company&lt;/h2&gt;&lt;/center&gt;\n"</span>
00504            <span class="stringliteral">"&lt;center&gt;&lt;h3&gt;For One Month and "</span>;
00505     <span class="keywordflow">if</span>(monthRangeInt == 1)
00506         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"One Month"</span>;
00507     <span class="keywordflow">else</span>
00508         <a class="code" href="classReportsGenerator.html#r6">html</a> += monthRange + <span class="stringliteral">" Months"</span>;
00509 
00510     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">" Ended "</span> + periodEnd.toString(<span class="stringliteral">"MMM d, yyyy"</span>) + <span class="stringliteral">"&lt;/h3&gt;\n"</span>
00511             <span class="stringliteral">"&lt;table width=\"80%\"&gt;&lt;tr&gt;"</span>
00512             <span class="stringliteral">"&lt;td width=\"50%\"&gt;&lt;b&gt;Account Description&lt;/b&gt;&lt;/td&gt;"</span>
00513             <span class="stringliteral">"&lt;td align=\"right\" width=\"25%\"&gt;&lt;b&gt;One Month&lt;/b&gt;&lt;/td&gt;"</span>
00514             <span class="stringliteral">"&lt;td align=\"right\" width=\"25%\"&gt;&lt;b&gt;"</span>;
00515     <span class="keywordflow">if</span>(monthRangeInt == 1)
00516         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"One Month"</span>;
00517     <span class="keywordflow">else</span>
00518         <a class="code" href="classReportsGenerator.html#r6">html</a> += monthRange + <span class="stringliteral">" Months"</span>;
00519 
00520     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/center&gt;"</span>
00521             <span class="stringliteral">"&lt;center&gt;&lt;table width=\"80%\"&gt;"</span>;
00522 
00523     vector&lt;ReportsEditor::Section&gt; sections;
00524     sections.push_back(ReportsEditor::Income);
00525     sections.push_back(ReportsEditor::Expenses);
00526 
00527     Q_INT64 sectionBalanceRange;
00528     Q_INT64 sectionBalanceMonth;
00529     Q_INT64 accountBalanceRange;
00530     Q_INT64 accountBalanceMonth;
00531 
00532     <span class="keywordflow">for</span>(vector&lt;ReportsEditor::Section&gt;::const_iterator sectionIt =
00533         sections.begin(); sectionIt != sections.end(); ++sectionIt)
00534     {
00535         sectionBalanceRange = 0;
00536         sectionBalanceMonth = 0;
00537 
00538         vector&lt;ReportsEditor::Entity*&gt; entities =
00539             reportsEditor-&gt;<a class="code" href="classReportsEditor.html#a7">getEntities</a>(ReportsEditor::IncomeSvc, *sectionIt);
00540 
00541         <span class="keywordflow">for</span>(vector&lt;ReportsEditor::Entity*&gt;::const_iterator entityIt =
00542             entities.begin(); entityIt != entities.end(); ++entityIt)
00543         {
00544             accountBalanceRange = 0;
00545             accountBalanceMonth = 0;
00546 
00547             vector&lt;JournalData::JournalRecord*&gt; recordsRange =
00548                 journalData-&gt;<a class="code" href="classJournalData.html#a6">getJournalRecords</a>((*entityIt)-&gt;accountBegin,
00549                     (*entityIt)-&gt;accountEnd, rangeBegin, periodEnd);
00550 
00551             <span class="keywordflow">for</span>(vector&lt;JournalData::JournalRecord*&gt;::const_iterator recordRangeIt =
00552                 recordsRange.begin(); recordRangeIt != recordsRange.end();
00553                 ++recordRangeIt)
00554             {
00555                 accountBalanceRange += (*recordRangeIt)-&gt;amount;
00556             }
00557 
00558             vector&lt;JournalData::JournalRecord*&gt; recordsMonth =
00559                 journalData-&gt;<a class="code" href="classJournalData.html#a6">getJournalRecords</a>((*entityIt)-&gt;accountBegin,
00560                     (*entityIt)-&gt;accountEnd, monthBegin, periodEnd);
00561 
00562             <span class="keywordflow">for</span>(vector&lt;JournalData::JournalRecord*&gt;::const_iterator recordMonthIt =
00563                 recordsMonth.begin(); recordMonthIt != recordsMonth.end();
00564                 ++recordMonthIt)
00565             {
00566                 accountBalanceMonth += (*recordMonthIt)-&gt;amount;
00567             }
00568 
00569             sectionBalanceRange += accountBalanceRange;
00570             sectionBalanceMonth += accountBalanceMonth;
00571 
00572             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"50%\"&gt;"</span> + (*entityIt)-&gt;desc + <span class="stringliteral">"&lt;/td&gt;"</span>
00573                     <span class="stringliteral">"&lt;td align=\"right\" width=\"25%\"&gt;"</span> +
00574                     <a class="code" href="main_8h.html#a0">formatCurrency</a>(accountBalanceMonth) + <span class="stringliteral">"&lt;/td&gt;"</span>
00575                     <span class="stringliteral">"&lt;td align=\"right\" width=\"25%\"&gt;"</span> +
00576                     <a class="code" href="main_8h.html#a0">formatCurrency</a>(accountBalanceRange) + <span class="stringliteral">"&lt;/td&gt;&lt;/tr&gt;\n"</span>;
00577 
00578             <a class="code" href="classReportsGenerator.html#r7">csv</a> += (*entityIt)-&gt;desc + <span class="stringliteral">","</span> +
00579                    <a class="code" href="main_8h.html#a0">formatCurrency</a>(accountBalanceMonth, <span class="keyword">false</span>) + <span class="stringliteral">","</span> +
00580                    <a class="code" href="main_8h.html#a0">formatCurrency</a>(accountBalanceRange, <span class="keyword">false</span>) + <span class="stringliteral">"\n"</span>;
00581         }
00582 
00583         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;\n"</span>
00584                 <span class="stringliteral">"&lt;tr&gt;&lt;td align=\"right\" width=\"50%\"&gt;&lt;b&gt;"</span>;
00585         <span class="keywordflow">if</span>((*sectionIt) == ReportsEditor::Income)
00586         {
00587             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"Total Income"</span>;
00588             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">"\"Total Income\""</span>;
00589         }
00590         <span class="keywordflow">else</span> <span class="keywordflow">if</span>((*sectionIt) == ReportsEditor::Expenses)
00591         {
00592             <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"Total Expenses"</span>;
00593             <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">"\"Total Expenses\""</span>;
00594         }
00595         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;&lt;td align=\"right\" width=\"25%\"&gt;&lt;b&gt;"</span> +
00596                 <a class="code" href="main_8h.html#a0">formatCurrency</a>(sectionBalanceMonth) + <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;"</span>
00597                 <span class="stringliteral">"&lt;td align=\"right\" width=\"25%\"&gt;&lt;b&gt;"</span> +
00598                 <a class="code" href="main_8h.html#a0">formatCurrency</a>(sectionBalanceRange) + <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;\n"</span>;
00599 
00600         <a class="code" href="classReportsGenerator.html#r7">csv</a> += <span class="stringliteral">","</span> + <a class="code" href="main_8h.html#a0">formatCurrency</a>(sectionBalanceMonth, <span class="keyword">false</span>) + <span class="stringliteral">","</span> +
00601                 <a class="code" href="main_8h.html#a0">formatCurrency</a>(sectionBalanceRange, <span class="keyword">false</span>) + <span class="stringliteral">"\n"</span>;
00602     }
00603 
00604     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;\n"</span>;
00605 }
00606 
<a name="l00607"></a><a class="code" href="classReportsGenerator.html#a5">00607</a> <span class="keywordtype">void</span> <a class="code" href="classReportsGenerator.html#a5">ReportsGenerator::genIncomeRetailReport</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a> periodEnd)
00608 {
00609 
00610 }
00611 
<a name="l00612"></a><a class="code" href="classReportsGenerator.html#a6">00612</a> <span class="keywordtype">void</span> <a class="code" href="classReportsGenerator.html#a6">ReportsGenerator::genChartOfAccountsReport</a>()
00613 {
00614     <a class="code" href="classReportsGenerator.html#a11">setDocName</a>(<span class="stringliteral">"Chart of Accounts"</span>);
00615     <a class="code" href="classReportsGenerator.html#r7">csv</a> = <span class="stringliteral">"\"Account ID\",\"Account Description\"\n"</span>;
00616     header = <span class="stringliteral">"&lt;html&gt;&lt;body&gt;&lt;center&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00617          <span class="stringliteral">"&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;"</span>;
00618     <a class="code" href="classReportsGenerator.html#r6">html</a> = <span class="stringliteral">"&lt;html&gt;&lt;head&gt;&lt;title&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00619            <span class="stringliteral">" - Chart of Accounts&lt;/title&gt;&lt;/head&gt;&lt;body&gt;\n"</span>
00620            <span class="stringliteral">"&lt;center&gt;&lt;h1&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() + <span class="stringliteral">"&lt;/center&gt;&lt;/h1&gt;\n"</span>
00621            <span class="stringliteral">"&lt;center&gt;&lt;h2&gt;Chart of Accounts&lt;/h2&gt;&lt;/center&gt;\n"</span>
00622            <span class="stringliteral">"&lt;center&gt;&lt;h3&gt;As of "</span> + QDate::currentDate().toString(<span class="stringliteral">"MMM d, yyyy"</span>) +
00623            <span class="stringliteral">"&lt;/h3&gt;&lt;/center&gt;\n"</span>
00624            <span class="stringliteral">"&lt;table width=\"100%\"&gt;&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;"</span>
00625        <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"15%\"&gt;&lt;b&gt;Account ID&lt;/b&gt;&lt;/td&gt;"</span>
00626            <span class="stringliteral">"&lt;td width=\"40%\"&gt;&lt;b&gt;Account Description&lt;/b&gt;&lt;/td&gt;"</span>
00627            <span class="stringliteral">"&lt;td width=\"45%\"&gt; &lt;/td&gt;&lt;/tr&gt;\n"</span>
00628            <span class="stringliteral">"&lt;table width=\"100%\"&gt;\n"</span>;
00629 
00630     <span class="comment">// Get all accounts, with no accountBegin or accountEnd, with sorting, with REAccount added</span>
00631     vector&lt;AccountsData::Account*&gt; accounts = accountsData-&gt;<a class="code" href="classAccountsData.html#a5">getAccounts</a>(
00632                     <span class="stringliteral">""</span>, <span class="stringliteral">""</span>, <span class="keyword">true</span>, <span class="keyword">true</span>);
00633 
00634     <span class="keywordflow">for</span>(vector&lt;AccountsData::Account*&gt;::const_iterator it = accounts.begin();
00635                     it != accounts.end(); ++it)
00636     {
00637         <a class="code" href="classReportsGenerator.html#r7">csv</a> += (*it)-&gt;id + <span class="stringliteral">",\""</span> + (*it)-&gt;desc + <span class="stringliteral">"\"\n"</span>;
00638         <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"15%\"&gt;"</span> + (*it)-&gt;id + <span class="stringliteral">"&lt;/td&gt;"</span>
00639                 <span class="stringliteral">"&lt;td width=\"40%\"&gt;"</span> + (*it)-&gt;desc + <span class="stringliteral">"&lt;/td&gt;"</span>
00640                 <span class="stringliteral">"&lt;td width=\"45%\"&gt; &lt;/td&gt;&lt;/tr&gt;\n"</span>;
00641     }
00642 
00643     <a class="code" href="classReportsGenerator.html#r6">html</a> += <span class="stringliteral">"&lt;/body&gt;&lt;/html&gt;"</span>;
00644 }
00645 
<a name="l00646"></a><a class="code" href="classReportsGenerator.html#a7">00646</a> <span class="keywordtype">bool</span> <a class="code" href="classReportsGenerator.html#a7">ReportsGenerator::printJournalEntryReport</a>()
00647 {
00648     <a class="code" href="classReportsPrint.html">ReportsPrint</a> *reportsPrint = <a class="code" href="classReportsPrint.html#e0">ReportsPrint::instance</a>();
00649 
00650     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> tmpHeader;
00651     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> tmpHtml;
00652 
00653     tmpHeader = <span class="stringliteral">"&lt;html&gt;&lt;body&gt;&lt;center&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00654             <span class="stringliteral">" - Journal Entry Report&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;"</span>;
00655     tmpHtml = <span class="stringliteral">"&lt;html&gt;&lt;head&gt;&lt;title&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00656           <span class="stringliteral">"&lt;/title&gt;&lt;/head&gt;&lt;/body&gt;\n"</span>
00657           <span class="stringliteral">"&lt;center&gt;&lt;h1&gt;"</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() + <span class="stringliteral">"&lt;/h1&gt;&lt;/center&gt;\n"</span>
00658           <span class="stringliteral">"&lt;center&gt;&lt;h2&gt;Journal Entry Report&lt;/h2&gt;&lt;/center&gt;\n"</span>
00659           <span class="stringliteral">"&lt;center&gt;&lt;h3&gt;Entered "</span> + QDate::currentDate().toString(<span class="stringliteral">"MMM d, yyyy"</span>) +
00660           <span class="stringliteral">"&lt;/h3&gt;&lt;/center&gt;\n"</span>
00661           <span class="stringliteral">"&lt;table width=\"100%\"&gt;&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;"</span>
00662           <span class="stringliteral">"&lt;td width=\"10%\"&gt;&lt;b&gt;Date&lt;/b&gt;&lt;/td&gt;"</span>
00663           <span class="stringliteral">"&lt;td width=\"10%\"&gt;&lt;b&gt;Account&lt;/b&gt;&lt;/td&gt;"</span>
00664           <span class="stringliteral">"&lt;td width=\"10%\"&gt;&lt;b&gt;Reference&lt;/b&gt;&lt;/td&gt;"</span>
00665           <span class="stringliteral">"&lt;td width=\"50%\"&gt;&lt;b&gt;Description&lt;/b&gt;&lt;/td&gt;"</span>
00666           <span class="stringliteral">"&lt;td width=\"10%\" align=\"right\"&gt;&lt;b&gt;Debit Amt&lt;/b&gt;&lt;/td&gt;"</span>
00667           <span class="stringliteral">"&lt;td width=\"10%\" align=\"right\"&gt;&lt;b&gt;Credit Amt&lt;/b&gt;&lt;/td&gt;"</span>
00668           <span class="stringliteral">"&lt;\tr&gt;\n"</span>;
00669 
00670     Q_INT64 debitBalance = 0;
00671     Q_INT64 creditBalance = 0;
00672 
00673     vector&lt;JournalData::JournalRecord*&gt; journalTmpRecords;
00674 
00675     <span class="comment">// Get all journalTmp entries</span>
00676     journalTmpRecords = journalData-&gt;<a class="code" href="classJournalData.html#a5">getJournalTmpRecords</a>();
00677 
00678     <span class="keywordflow">for</span>(vector&lt;JournalData::JournalRecord*&gt;::const_iterator it =
00679     journalTmpRecords.begin(); it != journalTmpRecords.end(); ++it)
00680     {
00682     tmpHtml += <span class="stringliteral">"&lt;tr&gt;"</span>
00683            <span class="stringliteral">"&lt;td width=\"10%\"&gt;"</span> + ((*it)-&gt;date).toString(<span class="stringliteral">"MM/dd/yyyy"</span>) + <span class="stringliteral">"&lt;/td&gt;"</span>
00684            <span class="stringliteral">"&lt;td width=\"10%\"&gt;"</span> + (*it)-&gt;account + <span class="stringliteral">"&lt;/td&gt;"</span>
00685            <span class="stringliteral">"&lt;td width=\"10%\"&gt;"</span> + (*it)-&gt;reference + <span class="stringliteral">"&lt;/td&gt;"</span>
00686            <span class="stringliteral">"&lt;td width=\"50%\"&gt;"</span> + (*it)-&gt;desc + <span class="stringliteral">"&lt;/td&gt;"</span>;
00687     <span class="keywordflow">if</span>((*it)-&gt;amount &gt; 0)
00688     {
00689         debitBalance += (*it)-&gt;amount;
00690         tmpHtml += <span class="stringliteral">"&lt;td align=\"right\" width=\"10%\"&gt;"</span> +
00691                <a class="code" href="main_8h.html#a0">formatCurrency</a>((*it)-&gt;amount) +
00692                <span class="stringliteral">"&lt;/td&gt;&lt;td width=\"10%\"&gt; &lt;/td&gt;"</span>;
00693     }
00694     <span class="keywordflow">else</span>
00695     {
00696         creditBalance += (*it)-&gt;amount;
00697         tmpHtml += <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;&lt;td align=\"right\" width=\"10%\"&gt;"</span> +
00698                <a class="code" href="main_8h.html#a0">formatCurrency</a>((*it)-&gt;amount) + <span class="stringliteral">"&lt;/td&gt;"</span>;
00699     }
00700     
00701     tmpHtml += <span class="stringliteral">"&lt;/tr&gt;"</span>;
00702     }
00703 
00704     tmpHtml += <span class="stringliteral">"&lt;tr&gt;&lt;td&gt; &lt;/td&gt;&lt;/tr&gt;\n"</span>
00705            <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"80%\" align=\"right\" colspan=\"4\"&gt;Debit:&lt;/td&gt;"</span>
00706            <span class="stringliteral">"&lt;td width=\"10%\" align=\"right\"&gt;"</span> +
00707            <a class="code" href="main_8h.html#a0">formatCurrency</a>(debitBalance) +
00708            <span class="stringliteral">"&lt;/td&gt;&lt;td width=\"10%\"&gt; &lt;/td&gt;&lt;/tr&gt;"</span>
00709            <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"80%\" align=\"right\" colspan=\"4\"&gt;Credit:&lt;/td&gt;"</span>
00710            <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;&lt;td width=\"10%\" align=\"right\"&gt;"</span> +
00711            <a class="code" href="main_8h.html#a0">formatCurrency</a>(creditBalance) +
00712            <span class="stringliteral">"&lt;/td&gt;&lt;/tr&gt;"</span>
00713            <span class="stringliteral">"&lt;tr&gt;&lt;td width=\"80%\" align=\"right\" colspan=\"4\"&gt;"</span>
00714            <span class="stringliteral">"&lt;b&gt;Out of Balance:&lt;/b&gt;&lt;/td&gt;"</span>
00715            <span class="stringliteral">"&lt;td width=\"10%\"&gt; &lt;/td&gt;&lt;td width=\"10%\" align=\"right\"&gt;&lt;b&gt;"</span> +
00716            <a class="code" href="main_8h.html#a0">formatCurrency</a>(debitBalance + creditBalance) +
00717            <span class="stringliteral">"&lt;/b&gt;&lt;/td&gt;&lt;/tr&gt;"</span>
00718            <span class="stringliteral">"&lt;/table&gt;&lt;/body&gt;&lt;/html&gt;"</span>;
00719 
00720     <span class="keywordflow">return</span> reportsPrint-&gt;<a class="code" href="classReportsPrint.html#a1">printReport</a>(tmpHeader, tmpHtml,
00721             <span class="stringliteral">"General Ledger - "</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00722             <span class="stringliteral">" Journal Entry Report"</span>);
00723 }
00724 
<a name="l00725"></a><a class="code" href="classReportsGenerator.html#a8">00725</a> <span class="keyword">const</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a>&amp; <a class="code" href="classReportsGenerator.html#a8">ReportsGenerator::getReportHeader</a>()<span class="keyword"> const</span>
00726 <span class="keyword"></span>{
00727     <span class="keywordflow">return</span> header;
00728 }
00729 
<a name="l00730"></a><a class="code" href="classReportsGenerator.html#a9">00730</a> <span class="keyword">const</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a>&amp; <a class="code" href="classReportsGenerator.html#a9">ReportsGenerator::getReportHTML</a>()<span class="keyword"> const</span>
00731 <span class="keyword"></span>{
00732     <span class="keywordflow">return</span> <a class="code" href="classReportsGenerator.html#r6">html</a>;
00733 }
00734 
<a name="l00735"></a><a class="code" href="classReportsGenerator.html#a10">00735</a> <span class="keyword">const</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a>&amp; <a class="code" href="classReportsGenerator.html#a10">ReportsGenerator::getReportCSV</a>()<span class="keyword"> const</span>
00736 <span class="keyword"></span>{
00737     <span class="keywordflow">return</span> <a class="code" href="classReportsGenerator.html#r7">csv</a>;
00738 }
00739 
<a name="l00740"></a><a class="code" href="classReportsGenerator.html#d1">00740</a> <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> <a class="code" href="classReportsGenerator.html#d1">ReportsGenerator::numberToString</a>(<span class="keywordtype">int</span> number)<span class="keyword"> const</span>
00741 <span class="keyword"></span>{
00742     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> string;
00743 
00744     <span class="keywordflow">switch</span>(number) {
00745         <span class="keywordflow">case</span> 1:
00746             string = <span class="stringliteral">"One"</span>;
00747             <span class="keywordflow">break</span>;
00748         <span class="keywordflow">case</span> 2:
00749             string = <span class="stringliteral">"Two"</span>;
00750             <span class="keywordflow">break</span>;
00751         <span class="keywordflow">case</span> 3:
00752             string = <span class="stringliteral">"Three"</span>;
00753             <span class="keywordflow">break</span>;
00754         <span class="keywordflow">case</span> 4:
00755             string = <span class="stringliteral">"Four"</span>;
00756             <span class="keywordflow">break</span>;
00757         <span class="keywordflow">case</span> 5:
00758             string = <span class="stringliteral">"Five"</span>;
00759             <span class="keywordflow">break</span>;
00760         <span class="keywordflow">case</span> 6:
00761             string = <span class="stringliteral">"Six"</span>;
00762             <span class="keywordflow">break</span>;
00763         <span class="keywordflow">case</span> 7:
00764             string = <span class="stringliteral">"Seven"</span>;
00765             <span class="keywordflow">break</span>;
00766         <span class="keywordflow">case</span> 8:
00767             string = <span class="stringliteral">"Eight"</span>;
00768             <span class="keywordflow">break</span>;
00769         <span class="keywordflow">case</span> 9:
00770             string = <span class="stringliteral">"Nine"</span>;
00771             <span class="keywordflow">break</span>;
00772         <span class="keywordflow">case</span> 10:
00773             string = <span class="stringliteral">"Ten"</span>;
00774             <span class="keywordflow">break</span>;
00775         <span class="keywordflow">case</span> 11:
00776             string = <span class="stringliteral">"Eleven"</span>;
00777             <span class="keywordflow">break</span>;
00778         <span class="keywordflow">case</span> 12:
00779             string = <span class="stringliteral">"Twelve"</span>;
00780             <span class="keywordflow">break</span>;
00781         <span class="keywordflow">default</span>:
00782             string = <span class="stringliteral">"Invalid Number: "</span>
00783                      <span class="stringliteral">"reportsEditor.cpp::numberToString("</span>
00784                      + QString::number(number) + <span class="stringliteral">")"</span>;
00785             <span class="keywordflow">break</span>;
00786     }
00787 
00788     <span class="keywordflow">return</span> string;
00789 }
00790 
<a name="l00791"></a><a class="code" href="classReportsGenerator.html#a11">00791</a> <span class="keywordtype">void</span> <a class="code" href="classReportsGenerator.html#a11">ReportsGenerator::setDocName</a>(<span class="keyword">const</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> newDocName)
00792 {
00793     <a class="code" href="classReportsGenerator.html#r4">docName</a> = newDocName;
00794 }
00795 
<a name="l00796"></a><a class="code" href="classReportsGenerator.html#a12">00796</a> <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> <a class="code" href="classReportsGenerator.html#a12">ReportsGenerator::getDocName</a>()<span class="keyword"> const</span>
00797 <span class="keyword"></span>{
00798     <span class="keywordflow">return</span> (<span class="stringliteral">"General Ledger - "</span> + client-&gt;<a class="code" href="classClient.html#a7">getClientName</a>() +
00799         <span class="stringliteral">" - "</span> + <a class="code" href="classReportsGenerator.html#r4">docName</a>);
00800 }
00801 
<a name="l00802"></a><a class="code" href="classReportsGenerator.html#d0">00802</a> <a class="code" href="classReportsGenerator.html#d0">ReportsGenerator::ReportsGenerator</a>()
00803 {
00804     client = <a class="code" href="classClient.html#e0">Client::instance</a>();
00805     accountsData = <a class="code" href="classAccountsData.html#e0">AccountsData::instance</a>();
00806     journalData = <a class="code" href="classJournalData.html#e0">JournalData::instance</a>();
00807     reportsEditor = <a class="code" href="classReportsEditor.html#e0">ReportsEditor::instance</a>();
00808 
00809     <a class="code" href="classReportsGenerator.html#r6">html</a> = QString::null;
00810     <a class="code" href="classReportsGenerator.html#r7">csv</a> = QString::null;
00811 }
00812 
00813 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Jan 16 16:23:28 2005 for General Ledger by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
