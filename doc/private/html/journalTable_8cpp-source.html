<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>General Ledger: journalTable.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>journalTable.cpp</h1><a href="journalTable_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* General Ledger, Copyright (C) 2004  Joshua Eckroth &lt;josh@eckroth.net&gt;</span>
00002 <span class="comment"> * http://www.eckroth.net/software/genledg</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
00005 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment"> * (at your option) any later version.</span>
00008 <span class="comment"> * </span>
00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment"> * GNU General Public License for more details.</span>
00013 <span class="comment"> * </span>
00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00015 <span class="comment"> * along with this program; if not, write to the Free Software</span>
00016 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  US</span>
00017 <span class="comment">*/</span>
00018 
00019 <span class="preprocessor">#include &lt;vector&gt;</span>
00020 <span class="keyword">using</span> std::vector;
00021 
00022 <span class="preprocessor">#include &lt;cmath&gt;</span>
00023 <span class="keyword">using</span> std::abs;
00024 
00025 <span class="preprocessor">#include &lt;qtable.h&gt;</span>
00026 <span class="preprocessor">#include &lt;qstringlist.h&gt;</span>
00027 <span class="preprocessor">#include &lt;qevent.h&gt;</span>
00028 <span class="preprocessor">#include &lt;qdialog.h&gt;</span>
00029 <span class="preprocessor">#include &lt;qlayout.h&gt;</span>
00030 <span class="preprocessor">#include &lt;qdatetime.h&gt;</span>
00031 <span class="preprocessor">#include &lt;qlabel.h&gt;</span>
00032 <span class="preprocessor">#include &lt;qpushbutton.h&gt;</span>
00033 <span class="preprocessor">#include &lt;qlineedit.h&gt;</span>
00034 
00035 <span class="preprocessor">#include "config.h"</span>
00036 <span class="preprocessor">#include "<a class="code" href="journalTable_8h.html">journalTable.h</a>"</span>
00037 <span class="preprocessor">#include "<a class="code" href="journalData_8h.html">journalData.h</a>"</span>
00038 <span class="preprocessor">#include "<a class="code" href="journalEditDesc_8h.html">journalEditDesc.h</a>"</span>
00039 <span class="preprocessor">#include "<a class="code" href="journalEditDate_8h.html">journalEditDate.h</a>"</span>
00040 <span class="preprocessor">#include "<a class="code" href="journalEditCurrency_8h.html">journalEditCurrency.h</a>"</span>
00041 <span class="preprocessor">#include "<a class="code" href="journalEditCurrencyValidator_8h.html">journalEditCurrencyValidator.h</a>"</span>
00042 <span class="preprocessor">#include "<a class="code" href="journalEditAccount_8h.html">journalEditAccount.h</a>"</span>
00043 <span class="preprocessor">#include "<a class="code" href="accountsData_8h.html">accountsData.h</a>"</span>
00044 <span class="preprocessor">#include "<a class="code" href="client_8h.html">client.h</a>"</span>
00045 
<a name="l00046"></a><a class="code" href="classJournalTable.html#a0">00046</a> <a class="code" href="classJournalTable.html#a0">JournalTable::JournalTable</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qwidget.html">QWidget</a> *parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name)
00047     : <a class="codeRef" doxygen="doxy-qt.tag:" href="qtable.html">QTable</a>(parent,name)  
00048 {
00049     journalData = <a class="code" href="classJournalData.html#e0">JournalData::instance</a>();
00050     accountsData = <a class="code" href="classAccountsData.html#e0">AccountsData::instance</a>();
00051     client = <a class="code" href="classClient.html#e0">Client::instance</a>();
00052 
00053     connect(accountsData, SIGNAL(accountsChanged()), <span class="keyword">this</span>, SLOT(<a class="code" href="classJournalTable.html#k0">updateAccounts</a>()));
00054 
00055     connect(client, SIGNAL(clientOpened(<a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a>)), <span class="keyword">this</span>, SLOT(<a class="code" href="classJournalTable.html#i0">populate</a>()));
00056     connect(client, SIGNAL(clientClosed(<a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a>)), <span class="keyword">this</span>, SLOT(<a class="code" href="classJournalTable.html#i1">unpopulate</a>()));
00057 
00058     setLeftMargin(0);
00059     setVScrollBarMode(QScrollView::AlwaysOn);
00060     setSelectionMode(QTable::NoSelection);
00061     setFocusStyle(QTable::SpreadSheet);
00062     
00063     insertColumns(0,6);
00064     
00065     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstringlist.html">QStringList</a> labels;
00066     labels &lt;&lt; <span class="stringliteral">"Date"</span> &lt;&lt; <span class="stringliteral">"Account"</span> &lt;&lt; <span class="stringliteral">"Reference"</span> &lt;&lt; <span class="stringliteral">"Description"</span> &lt;&lt; <span class="stringliteral">"Debit"</span> &lt;&lt; <span class="stringliteral">"Credit"</span>;
00067     setColumnLabels(labels);
00068               
00069     setColumnStretchable(3, <span class="keyword">true</span>);
00070 
00071     setColumnWidth(1, columnWidth(1) + 40);
00072     
00073     inserting = <span class="keyword">false</span>;
00074     editing = <span class="keyword">false</span>;
00075 }
00076 
<a name="l00077"></a><a class="code" href="classJournalTable.html#i0">00077</a> <span class="keywordtype">void</span> <a class="code" href="classJournalTable.html#i0">JournalTable::populate</a>()
00078 {
00079     <a class="code" href="classJournalTable.html#i1">unpopulate</a>();
00080 
00081     accounts = accountsData-&gt;<a class="code" href="classAccountsData.html#a13">getFormattedList</a>();
00082 
00083     vector&lt;JournalData::JournalRecord*&gt; records = journalData-&gt;<a class="code" href="classJournalData.html#a5">getJournalTmpRecords</a>();
00084     Q_UINT16 key = 0;
00085     <span class="keywordflow">for</span>(vector&lt;JournalData::JournalRecord*&gt;::const_iterator it = records.begin();
00086                     it != records.end(); ++it)
00087     {
00088         key++;
00089         <span class="keywordflow">if</span>((*it) != 0)
00090         {
00091             insertRows(0);
00092             setItem(0, 0, <span class="keyword">new</span> <a class="code" href="classJournalEditDate.html">JournalEditDate</a>(<span class="keyword">this</span>, (*it)-&gt;date));
00093             setItem(0, 1, <span class="keyword">new</span> <a class="code" href="classJournalEditAccount.html">JournalEditAccount</a>(<span class="keyword">this</span>, accounts, (*it)-&gt;account, key));
00094             setItem(0, 2, <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qtableitem.html">QTableItem</a>(<span class="keyword">this</span>, QTableItem::OnTyping, (*it)-&gt;reference));
00095             setItem(0, 3, <span class="keyword">new</span> <a class="code" href="classJournalEditDesc.html">JournalEditDesc</a>(<span class="keyword">this</span>, (*it)-&gt;desc));
00096             
00097             <span class="keywordflow">if</span>((*it)-&gt;amount &gt; 0)
00098             {
00099                 setItem(0, 4, <span class="keyword">new</span> <a class="code" href="classJournalEditCurrency.html">JournalEditCurrency</a>(<span class="keyword">this</span>, (*it)-&gt;amount));
00100                 setItem(0, 5, <span class="keyword">new</span> <a class="code" href="classJournalEditCurrency.html">JournalEditCurrency</a>(<span class="keyword">this</span>, 0));
00101             }
00102             <span class="keywordflow">else</span> <span class="keywordflow">if</span>((*it)-&gt;amount &lt; 0)
00103             {
00104                 setItem(0, 4, <span class="keyword">new</span> <a class="code" href="classJournalEditCurrency.html">JournalEditCurrency</a>(<span class="keyword">this</span>, 0));
00105                 setItem(0, 5, <span class="keyword">new</span> <a class="code" href="classJournalEditCurrency.html">JournalEditCurrency</a>(<span class="keyword">this</span>, abs((*it)-&gt;amount)));
00106             }
00107             <span class="keywordflow">else</span>
00108             {
00109                 setItem(0, 4, <span class="keyword">new</span> <a class="code" href="classJournalEditCurrency.html">JournalEditCurrency</a>(<span class="keyword">this</span>, 0));
00110                 setItem(0, 5, <span class="keyword">new</span> <a class="code" href="classJournalEditCurrency.html">JournalEditCurrency</a>(<span class="keyword">this</span>, 0));
00111             }
00112         }
00113     }
00114 
00115     <span class="keywordflow">if</span>(numRows())
00116         setCurrentCell(0,0);
00117 }
00118 
<a name="l00119"></a><a class="code" href="classJournalTable.html#i1">00119</a> <span class="keywordtype">void</span> <a class="code" href="classJournalTable.html#i1">JournalTable::unpopulate</a>()
00120 {
00121     <span class="keywordtype">int</span> rows = numRows();
00122     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> row = 0; row &lt;= rows; row++)
00123         removeRow(0);
00124 }
00125 
<a name="l00126"></a><a class="code" href="classJournalTable.html#d1">00126</a> <span class="keywordtype">void</span> <a class="code" href="classJournalTable.html#d1">JournalTable::insert</a>()
00127 {
00128     inserting = <span class="keyword">true</span>;
00129     editing = <span class="keyword">true</span>;
00130 
00131     <span class="keywordtype">int</span> newRow = numRows();
00132     insertRows(newRow);
00133 
00134     ensureCellVisible(newRow, 0);
00135     setItem(newRow, 0, <span class="keyword">new</span> <a class="code" href="classJournalEditDate.html">JournalEditDate</a>(<span class="keyword">this</span>, <a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a>()));
00136     setItem(newRow, 1, <span class="keyword">new</span> <a class="code" href="classJournalEditAccount.html">JournalEditAccount</a>(<span class="keyword">this</span>, accounts, <span class="stringliteral">""</span>,
00137                             journalData-&gt;<a class="code" href="classJournalData.html#a9">getNextTmpRecordKey</a>()));
00138     setItem(newRow, 2, <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qtableitem.html">QTableItem</a>(<span class="keyword">this</span>, QTableItem::OnTyping));
00139     setItem(newRow, 3, <span class="keyword">new</span> <a class="code" href="classJournalEditDesc.html">JournalEditDesc</a>(<span class="keyword">this</span>, <span class="stringliteral">""</span>));
00140     setItem(newRow, 4, <span class="keyword">new</span> <a class="code" href="classJournalEditCurrency.html">JournalEditCurrency</a>(<span class="keyword">this</span>, 0));
00141     setItem(newRow, 5, <span class="keyword">new</span> <a class="code" href="classJournalEditCurrency.html">JournalEditCurrency</a>(<span class="keyword">this</span>, 0));
00142     setCurrentCell(newRow,0);
00143 
00144     beginEdit(newRow, 0, <span class="keyword">false</span>);
00145 }
00146 
<a name="l00147"></a><a class="code" href="classJournalTable.html#a1">00147</a> <span class="keywordtype">bool</span> <a class="code" href="classJournalTable.html#a1">JournalTable::isInserting</a>()<span class="keyword"> const</span>
00148 <span class="keyword"></span>{
00149     <span class="keywordflow">return</span> inserting;
00150 }
00151 
<a name="l00152"></a><a class="code" href="classJournalTable.html#k0">00152</a> <span class="keywordtype">void</span> <a class="code" href="classJournalTable.html#k0">JournalTable::updateAccounts</a>()
00153 {
00154     accounts = accountsData-&gt;<a class="code" href="classAccountsData.html#a13">getFormattedList</a>();
00155 
00156     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numRows(); i++)
00157         ((<a class="code" href="classJournalEditAccount.html">JournalEditAccount</a>*)(item(i, 1)))-&gt;updateAccounts(accounts);
00158 }
00159 
<a name="l00160"></a><a class="code" href="classJournalTable.html#d2">00160</a> <span class="keywordtype">void</span> <a class="code" href="classJournalTable.html#d2">JournalTable::remove</a>(<span class="keywordtype">int</span> row)
00161 {
00162     Q_UINT16 key = ((<a class="code" href="classJournalEditAccount.html">JournalEditAccount</a>*)(item(row, 1)))-&gt;getKey();
00163     
00164     <a class="codeRef" doxygen="doxy-qt.tag:" href="qdialog.html">QDialog</a> *dialog = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qdialog.html">QDialog</a>;
00165     dialog-&gt;setCaption(<span class="stringliteral">"Delete Record"</span>);
00166 
00167     <a class="codeRef" doxygen="doxy-qt.tag:" href="qvboxlayout.html">QVBoxLayout</a> *vBoxLayout = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qvboxlayout.html">QVBoxLayout</a>(dialog);
00168     vBoxLayout-&gt;setMargin(5);
00169     vBoxLayout-&gt;setSpacing(5);
00170 
00171     <a class="codeRef" doxygen="doxy-qt.tag:" href="qlabel.html">QLabel</a> *label = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qlabel.html">QLabel</a>(<span class="stringliteral">"&lt;nobr&gt;Are you sure you want to delete the selected record?&lt;/nobr&gt;"</span>, dialog);
00172 
00173     vBoxLayout-&gt;addWidget(label);
00174 
00175     vBoxLayout-&gt;addSpacing(10);
00176 
00177     <a class="codeRef" doxygen="doxy-qt.tag:" href="qhboxlayout.html">QHBoxLayout</a> *hBoxLayout = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qhboxlayout.html">QHBoxLayout</a>(vBoxLayout);
00178     hBoxLayout-&gt;setSpacing(5);
00179 
00180     <a class="codeRef" doxygen="doxy-qt.tag:" href="qpushbutton.html">QPushButton</a> *buttonDelete = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qpushbutton.html">QPushButton</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qiconset.html">QIconSet</a>(
00181                              QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/deleteButton.png"</span>)),
00182                              <span class="stringliteral">"Delete"</span>, dialog);
00183     connect(buttonDelete, SIGNAL(clicked()), dialog, SLOT(accept()));
00184 
00185     QPushButton *buttonDontDelete = <span class="keyword">new</span> QPushButton(<a class="codeRef" doxygen="doxy-qt.tag:" href="qiconset.html">QIconSet</a>(
00186                              QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/okButton.png"</span>)),
00187                              <span class="stringliteral">"Don't Delete"</span>, dialog);
00188     connect(buttonDontDelete, SIGNAL(clicked()), dialog, SLOT(reject()));
00189 
00190     buttonDontDelete-&gt;setDefault(<span class="keyword">true</span>);
00191 
00192     hBoxLayout-&gt;addStretch();
00193     hBoxLayout-&gt;addWidget(buttonDelete);
00194     hBoxLayout-&gt;addWidget(buttonDontDelete);
00195 
00196     <span class="keywordflow">if</span>(dialog-&gt;exec())
00197     {
00198         journalData-&gt;<a class="code" href="classJournalData.html#a8">deleteTmpRecord</a>(key);
00199         removeRow(row);
00200     }
00201     <span class="keywordflow">if</span>(row &gt; 0)
00202         setCurrentCell(row - 1, 0);
00203 
00204     <span class="keyword">delete</span> dialog;
00205 }
00206 
<a name="l00207"></a><a class="code" href="classJournalTable.html#d0">00207</a> <span class="keywordtype">void</span> <a class="code" href="classJournalTable.html#d0">JournalTable::updateDb</a>()
00208 {
00209     <span class="keywordtype">int</span> row = currentRow();
00210 
00211     Q_UINT16 key = ((<a class="code" href="classJournalEditAccount.html">JournalEditAccount</a>*)(item(row, 1)))-&gt;getKey();
00212     <a class="codeRef" doxygen="doxy-qt.tag:" href="qdate.html">QDate</a> date = ((<a class="code" href="classJournalEditDate.html">JournalEditDate</a>*)(item(row, 0)))-&gt;date();
00213     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> account = text(row, 1);
00214     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> reference = text(row, 2);
00215     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> desc = text(row, 3);
00216     Q_INT64 amount = ((<a class="code" href="classJournalEditCurrency.html">JournalEditCurrency</a>*)(item(row, 4)))-&gt;value();
00217     amount -= ((<a class="code" href="classJournalEditCurrency.html">JournalEditCurrency</a>*)(item(row, 5)))-&gt;value();
00218     journalData-&gt;<a class="code" href="classJournalData.html#a7">updateTmpRecord</a>(key, date, account, reference, desc, amount);
00219 
00220     <span class="keywordflow">if</span>(inserting &amp;&amp; currentColumn() == 1 &amp;&amp; text(row, 3) == <span class="stringliteral">""</span>)
00221         setText(row, 3, accountsData-&gt;<a class="code" href="classAccountsData.html#a14">getDescription</a>(account));
00222 }
00223 
<a name="l00224"></a><a class="code" href="classJournalTable.html#d3">00224</a> <span class="keywordtype">void</span> <a class="code" href="classJournalTable.html#d3">JournalTable::keyPressEvent</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qkeyevent.html">QKeyEvent</a> *event)
00225 {
00226     <span class="keywordflow">switch</span>(event-&gt;key())
00227     {
00228         <span class="keywordflow">case</span> Key_Insert:
00229             <span class="keywordflow">if</span>(!inserting)
00230                 <a class="code" href="classJournalTable.html#d1">insert</a>();
00231             <span class="keywordflow">break</span>;
00232         <span class="keywordflow">case</span> Key_Delete:
00233             <span class="keywordflow">if</span>(!editing)
00234                 <a class="code" href="classJournalTable.html#d2">remove</a>(currentRow());
00235             <span class="keywordflow">else</span>
00236                 ((<a class="codeRef" doxygen="doxy-qt.tag:" href="qlineedit.html">QLineEdit</a>*)cellWidget(currentRow(), currentColumn()))-&gt;del();
00237             <span class="keywordflow">break</span>;
00238         <span class="keywordflow">case</span> Key_Tab:
00239             <span class="keywordflow">break</span>;
00240         <span class="keywordflow">case</span> Key_Enter:
00241         <span class="keywordflow">case</span> Key_Return:
00242             <span class="keywordflow">if</span>(inserting)
00243             {
00244                 <span class="keywordflow">if</span>(currentColumn() == 4)
00245                 {
00246                     endEdit(currentRow(), 4, <span class="keyword">true</span>, <span class="keyword">true</span>);
00247                     <a class="code" href="classJournalTable.html#d0">updateDb</a>();
00248 
00249                     <span class="keywordflow">if</span>(text(currentRow(), 5) == <span class="stringliteral">""</span> &amp;&amp; text(currentRow(), 4) != <span class="stringliteral">""</span>)
00250                     {
00251                         <a class="code" href="classJournalTable.html#d1">insert</a>();
00252                         <span class="keywordflow">break</span>;
00253                     }
00254                     <span class="keywordflow">else</span>
00255                     {
00256                         setCurrentCell(currentRow(), 5);
00257                         beginEdit(currentRow(), 5, <span class="keyword">false</span>);
00258                         <span class="keywordflow">break</span>;
00259                     }
00260                 }
00261                 
00262                 endEdit(currentRow(), currentColumn(), <span class="keyword">true</span>, <span class="keyword">true</span>);
00263                 <a class="code" href="classJournalTable.html#d0">updateDb</a>();
00264 
00265                 <span class="keywordflow">if</span>(currentColumn() == 5)
00266                 {
00267                     <a class="code" href="classJournalTable.html#d1">insert</a>();
00268                     <span class="keywordflow">break</span>;
00269                 }
00270 
00271                 <span class="keywordflow">if</span>(currentColumn() == 1)
00272                     setText(currentRow(), 3, accountsData-&gt;<a class="code" href="classAccountsData.html#a14">getDescription</a>(text(currentRow(), 1)));
00273 
00274                 <span class="keywordtype">int</span> nextCol = (currentColumn() + 1);
00275                 setCurrentCell(currentRow(), nextCol);
00276                 beginEdit(currentRow(), nextCol, <span class="keyword">false</span>);
00277                 <span class="keywordflow">break</span>;
00278             }
00279             <span class="keywordflow">else</span>
00280             {
00281                 <span class="keywordflow">if</span>(editing)
00282                 {
00283                     endEdit(currentRow(), currentColumn(), <span class="keyword">true</span>, <span class="keyword">true</span>);
00284                     editing = <span class="keyword">false</span>;
00285                     <a class="code" href="classJournalTable.html#d0">updateDb</a>();
00286                     <span class="keywordflow">break</span>;
00287                 }
00288                 <span class="keywordflow">else</span>
00289                 {
00290                     editing = <span class="keyword">true</span>;
00291                     beginEdit(currentRow(), currentColumn(), <span class="keyword">false</span>);
00292                     <span class="keywordflow">break</span>;
00293                 }
00294             }
00295         <span class="keywordflow">case</span> Key_Escape:
00296             <span class="keywordflow">if</span>(inserting)
00297             {
00298                 <span class="keywordflow">if</span>(currentColumn() == 0)
00299                 {
00300                     endEdit(currentRow(), 0, <span class="keyword">false</span>, <span class="keyword">false</span>);
00301                     removeRow(currentRow());
00302                     editing = <span class="keyword">false</span>;
00303                     inserting = <span class="keyword">false</span>;
00304                     setCurrentCell(numRows() - 1, 0);
00305                     <span class="keywordflow">break</span>;
00306                 }
00307                 <span class="keywordflow">else</span>
00308                 {
00309                     endEdit(currentRow(), currentColumn(), <span class="keyword">false</span>, <span class="keyword">false</span>);
00310                     inserting = <span class="keyword">false</span>;
00311                     editing = <span class="keyword">false</span>;
00312                     <a class="code" href="classJournalTable.html#d0">updateDb</a>();
00313                     <span class="keywordflow">break</span>;
00314                 }
00315             }
00316             <span class="keywordflow">if</span>(editing)
00317             {
00318                 endEdit(currentRow(), currentColumn(), <span class="keyword">false</span>, <span class="keyword">false</span>);
00319                 editing = <span class="keyword">false</span>;
00320                 <a class="code" href="classJournalTable.html#d0">updateDb</a>();
00321                 <span class="keywordflow">break</span>;
00322             }
00323             
00324             emit <a class="code" href="classJournalTable.html#l0">switchToHome</a>();
00325             <span class="keywordflow">break</span>;
00326         <span class="keywordflow">case</span> Key_Up:
00327         <span class="keywordflow">case</span> Key_Left:
00328         <span class="keywordflow">case</span> Key_Down:
00329         <span class="keywordflow">case</span> Key_Right:
00330         <span class="keywordflow">case</span> Key_Home:
00331         <span class="keywordflow">case</span> Key_End:
00332         <span class="keywordflow">case</span> Key_PageUp:
00333         <span class="keywordflow">case</span> Key_PageDown:
00334             <span class="keywordflow">if</span>(editing)
00335             {
00336                 <span class="keywordtype">int</span> curRow = currentRow();
00337                 <span class="keywordtype">int</span> curCol = currentColumn();
00338 
00339                 <span class="keywordflow">if</span>(curCol == 1)
00340                     <span class="keywordflow">break</span>;
00341 
00342                 <span class="keywordflow">switch</span>(event-&gt;key())
00343                 {
00344                     <span class="keywordflow">case</span> Key_Right:
00345                         ((<a class="codeRef" doxygen="doxy-qt.tag:" href="qlineedit.html">QLineEdit</a>*)cellWidget(curRow, curCol))-&gt;cursorForward(<span class="keyword">false</span>);
00346                         <span class="keywordflow">break</span>;
00347                     <span class="keywordflow">case</span> Key_Left:
00348                         ((<a class="codeRef" doxygen="doxy-qt.tag:" href="qlineedit.html">QLineEdit</a>*)cellWidget(curRow, curCol))-&gt;cursorBackward(<span class="keyword">false</span>);
00349                         <span class="keywordflow">break</span>;
00350                     <span class="keywordflow">case</span> Key_Home:
00351                         ((<a class="codeRef" doxygen="doxy-qt.tag:" href="qlineedit.html">QLineEdit</a>*)cellWidget(curRow, curCol))-&gt;home(<span class="keyword">false</span>);
00352                         <span class="keywordflow">break</span>;
00353                     <span class="keywordflow">case</span> Key_End:
00354                         ((<a class="codeRef" doxygen="doxy-qt.tag:" href="qlineedit.html">QLineEdit</a>*)cellWidget(curRow, curCol))-&gt;end(<span class="keyword">false</span>);
00355                         <span class="keywordflow">break</span>;
00356                     <span class="keywordflow">default</span>:
00357                         <span class="keywordflow">break</span>;
00358                 }
00359             }
00360             <span class="keywordflow">else</span>
00361             {
00362                 QTable::keyPressEvent(event);
00363             }
00364             <span class="keywordflow">break</span>;
00365         <span class="keywordflow">case</span> Key_F1:
00366             emit <a class="code" href="classJournalTable.html#l0">switchToHome</a>();
00367             <span class="keywordflow">break</span>;
00368         <span class="keywordflow">case</span> Key_F2:
00369             emit <a class="code" href="classJournalTable.html#l1">switchToAccounts</a>();
00370             <span class="keywordflow">break</span>;
00371         <span class="keywordflow">case</span> Key_F3:
00372             <span class="keywordflow">break</span>;
00373         <span class="keywordflow">case</span> Key_F4:
00374             emit <a class="code" href="classJournalTable.html#l2">switchToReports</a>();
00375             <span class="keywordflow">break</span>;
00376         <span class="keywordflow">case</span> Key_F5:
00377             emit <a class="code" href="classJournalTable.html#l3">switchToHelp</a>();
00378             <span class="keywordflow">break</span>;
00379         <span class="keywordflow">default</span>:
00380             <span class="keywordflow">break</span>;
00381     }
00382 }
00383 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Jan 16 16:23:28 2005 for General Ledger by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
