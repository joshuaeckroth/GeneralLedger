<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>General Ledger: ImportExport class Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>ImportExport Class Reference</h1>Utility class for importing and exporting database data.  
<a href="#_details">More...</a>
<p>
<code>#include &lt;<a class="el" href="importExport_8h-source.html">importExport.h</a>&gt;</code>
<p>
Inherits <a class="elRef" doxygen="doxy-qt.tag:" href="qobject.html">QObject</a>.
<p>
<a href="classImportExport-members.html">List of all members.</a><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Public Types</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>enum &nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImportExport.html#w2">DataCategory</a> { <a class="el" href="classImportExport.html#w2w0">Accounts</a>, 
<a class="el" href="classImportExport.html#w2w1">JournalTmp</a>
 }</td></tr>

<tr><td colspan=2><br><h2>Static Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImportExport.html#e0">importCSV</a> (const <a class="el" href="classImportExport.html#w2">ImportExport::DataCategory</a> cat)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImportExport.html#e1">exportCSV</a> (const <a class="el" href="classImportExport.html#w2">ImportExport::DataCategory</a> cat)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImportExport.html#e2">exportCSV</a> (const <a class="elRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> data)</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>void&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImportExport.html#e3">exportPDF</a> (const <a class="elRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> &amp;text)</td></tr>

<tr><td colspan=2><br><h2>Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImportExport.html#d0">ImportExport</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align=right valign=top>&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImportExport.html#d1">~ImportExport</a> ()</td></tr>

<tr><td colspan=2><br><h2>Static Private Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>bool&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="classImportExport.html#h0">overwriteDialog</a> ()</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Utility class for importing and exporting database data. 
<p>

<p>
Definition at line <a class="el" href="importExport_8h-source.html#l00028">28</a> of file <a class="el" href="importExport_8h-source.html">importExport.h</a>.<hr><h2>Member Enumeration Documentation</h2>
<a class="anchor" name="w2" doxytag="ImportExport::DataCategory" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> enum <a class="el" href="classImportExport.html#w2">ImportExport::DataCategory</a>
      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
<dl compact><dt><b>Enumeration values: </b></dt><dd>
<table border=0 cellspacing=2 cellpadding=0>
<tr><td valign=top><em><a class="anchor" name="w2w0" doxytag="Accounts" ></a>Accounts</em>&nbsp;</td><td>
</td></tr>
<tr><td valign=top><em><a class="anchor" name="w2w1" doxytag="JournalTmp" ></a>JournalTmp</em>&nbsp;</td><td>
</td></tr>
</table>
</dl>

<p>
Definition at line <a class="el" href="importExport_8h-source.html#l00032">32</a> of file <a class="el" href="importExport_8h-source.html">importExport.h</a>.
<p>
<div class="fragment"><pre>00032 { <a class="code" href="classImportExport.html#w2w0">Accounts</a>, <a class="code" href="classImportExport.html#w2w1">JournalTmp</a> };
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" name="d0" doxytag="ImportExport::ImportExport" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ImportExport::ImportExport </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="importExport_8cpp-source.html#l00277">277</a> of file <a class="el" href="importExport_8cpp-source.html">importExport.cpp</a>.
<p>
<div class="fragment"><pre>00277 {}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="d1" doxytag="ImportExport::~ImportExport" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> ImportExport::~<a class="el" href="classImportExport.html">ImportExport</a> </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="importExport_8cpp-source.html#l00279">279</a> of file <a class="el" href="importExport_8cpp-source.html">importExport.cpp</a>.
<p>
<div class="fragment"><pre>00279 {}
</pre></div>    </td>
  </tr>
</table>
<hr><h2>Member Function Documentation</h2>
<a class="anchor" name="e0" doxytag="ImportExport::importCSV" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool ImportExport::importCSV </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="classImportExport.html#w2">ImportExport::DataCategory</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cat</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Import CSV data into a table. 
<p>

<p>
Definition at line <a class="el" href="importExport_8cpp-source.html#l00044">44</a> of file <a class="el" href="importExport_8cpp-source.html">importExport.cpp</a>.
<p>
References <a class="el" href="classImportExport.html#w2w0">Accounts</a>, <a class="el" href="settings_8cpp-source.html#l00159">Settings::getImportPath()</a>, <a class="el" href="journalData_8cpp-source.html#l00376">JournalData::importCSV()</a>, <a class="el" href="accountsData_8cpp-source.html#l00304">AccountsData::importCSV()</a>, <a class="el" href="journalData_8cpp-source.html#l00037">JournalData::instance()</a>, <a class="el" href="accountsData_8cpp-source.html#l00035">AccountsData::instance()</a>, <a class="el" href="settings_8cpp-source.html#l00126">Settings::instance()</a>, <a class="el" href="classImportExport.html#w2w1">JournalTmp</a>, and <a class="el" href="settings_8cpp-source.html#l00164">Settings::setImportPath()</a>.
<p>
Referenced by <a class="el" href="journalTab_8cpp-source.html#l00125">JournalTab::importCSV()</a>, and <a class="el" href="accountsTab_8cpp-source.html#l00099">AccountsTab::importCSV()</a>.
<p>
<div class="fragment"><pre>00045 {
00046     <a class="code" href="classSettings.html">Settings</a> *settings = <a class="code" href="classSettings.html#e0">Settings::instance</a>();
00047         
00048     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> fileName = QFileDialog::getOpenFileName(
00049                     settings-&gt;<a class="code" href="classSettings.html#a5">getImportPath</a>(),
00050                     <span class="stringliteral">"Comma Separated Values (*.*)"</span>,
00051                     0, <span class="stringliteral">"importExport::import_file_dialog"</span>,
00052                     <span class="stringliteral">"Import CSV Data"</span>);
00053 
00054     <span class="keywordflow">if</span>(fileName != QString::null)
00055     {
00056         <span class="keywordtype">int</span> dirPos = fileName.findRev(<span class="stringliteral">"/"</span>);
00057         <span class="keywordflow">if</span>(dirPos == -1)
00058             dirPos = fileName.findRev(<span class="stringliteral">"\\"</span>);
00059 
00060         settings-&gt;<a class="code" href="classSettings.html#a6">setImportPath</a>(fileName.left(dirPos));
00061 
00062         <a class="codeRef" doxygen="doxy-qt.tag:" href="qfile.html">QFile</a> file(fileName);
00063         <span class="keywordflow">if</span>(file.open(IO_ReadOnly))
00064         {
00065             <a class="codeRef" doxygen="doxy-qt.tag:" href="qtextstream.html">QTextStream</a> in(&amp;file);
00066             in.setEncoding(QTextStream::Locale);
00067 
00068             <span class="comment">// Determine if the first line is data or field descriptors</span>
00069             <span class="keywordtype">bool</span> skipFirst = <span class="keyword">false</span>;
00070 
00071             <a class="codeRef" doxygen="doxy-qt.tag:" href="qstringlist.html">QStringList</a> data;
00072             <a class="codeRef" doxygen="doxy-qt.tag:" href="qptrlist.html">QPtrList&lt;QStringList&gt;</a> values;
00073             <a class="codeRef" doxygen="doxy-qt.tag:" href="qstringlist.html">QStringList</a> *list;
00074 
00075             <span class="keywordtype">int</span> i = 0;
00076             <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> line;
00077             <span class="keywordflow">while</span>(!in.atEnd())
00078             {
00079                 line = in.readLine();
00080                 data &lt;&lt; line;
00081 
00082                 <span class="keywordflow">if</span>(i &lt; 3)
00083                 {
00084                     list = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qstringlist.html">QStringList</a>(QStringList::split(<span class="stringliteral">","</span>, line));
00085                     values.append(list);
00086                 }
00087                 ++i;
00088             }
00089             
00090             <span class="keywordflow">if</span>(!values.isEmpty())
00091             {
00092                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qdialog.html">QDialog</a> dialog;
00093                 dialog.setCaption(<span class="stringliteral">"Import CSV Data"</span>);
00094 
00095                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qvboxlayout.html">QVBoxLayout</a> vBoxLayout(&amp;dialog, 5, 5);
00096                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qlabel.html">QLabel</a> label(<span class="stringliteral">"&lt;nobr&gt;The first three records of the file "</span>
00097                              <span class="stringliteral">"are shown.&lt;/nobr&gt;&lt;br&gt;"</span>
00098                              <span class="stringliteral">"&lt;nobr&gt;Choose whether the first row is "</span>
00099                              <span class="stringliteral">"a header or data.&lt;/nobr&gt;"</span>, &amp;dialog);
00100 
00101                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qtable.html">QTable</a> dataTable(3, values.first()-&gt;count(), &amp;dialog);
00102                 dataTable.setLeftMargin(0);
00103                 dataTable.setTopMargin(0);
00104                 dataTable.setSelectionMode(QTable::NoSelection);
00105 
00106                 <span class="keywordtype">int</span> row = 0;
00107                 <span class="keywordtype">int</span> col = 0;
00108                 <span class="keywordflow">for</span>(list = values.first(); list; list = values.next())
00109                 {
00110                     col = 0;
00111                     <span class="keywordflow">for</span>(QStringList::Iterator it = list-&gt;begin();
00112                         it != list-&gt;end(); ++it)
00113                     {
00114                         dataTable.setItem(row, col,
00115                             <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qtableitem.html">QTableItem</a>(&amp;dataTable, QTableItem::Never, *it));
00116                         ++col;
00117                     }
00118                     ++row;
00119                 }
00120                 dataTable.setColumnStretchable((col - 1), <span class="keyword">true</span>);
00121 
00122                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qvbuttongroup.html">QVButtonGroup</a> buttonGroup(&amp;dialog);
00123                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qradiobutton.html">QRadioButton</a> headerButton(<span class="stringliteral">"The first row is a header"</span>,
00124                                 &amp;buttonGroup);
00125                 headerButton.setChecked(<span class="keyword">true</span>);
00126                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qradiobutton.html">QRadioButton</a> dataButton(<span class="stringliteral">"The first row is data"</span>,
00127                                 &amp;buttonGroup);
00128                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qwidget.html">QWidget</a> okCancelWidget(&amp;dialog);
00129                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qhboxlayout.html">QHBoxLayout</a> okCancelLayout(&amp;okCancelWidget);
00130                 okCancelLayout.setSpacing(5);
00131 
00132                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qpushbutton.html">QPushButton</a> okButton(<a class="codeRef" doxygen="doxy-qt.tag:" href="qiconset.html">QIconSet</a>(QPixmap::fromMimeSource(
00133                                 ICON_PATH + <span class="stringliteral">"/okButton.png"</span>)),
00134                                 <span class="stringliteral">"OK"</span>, &amp;okCancelWidget);
00135                 connect(&amp;okButton, SIGNAL(clicked()),
00136                                 &amp;dialog, SLOT(accept()));
00137                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qpushbutton.html">QPushButton</a> cancelButton(<a class="codeRef" doxygen="doxy-qt.tag:" href="qiconset.html">QIconSet</a>(QPixmap::fromMimeSource(
00138                                 ICON_PATH + <span class="stringliteral">"/cancelButton.png"</span>)),
00139                                 <span class="stringliteral">"Cancel"</span>, &amp;okCancelWidget);
00140                 connect(&amp;cancelButton, SIGNAL(clicked()),
00141                                 &amp;dialog, SLOT(reject()));
00142 
00143                 okCancelLayout.addStretch();
00144                 okCancelLayout.addWidget(&amp;okButton);
00145                 okCancelLayout.addWidget(&amp;cancelButton);
00146 
00147                 vBoxLayout.addWidget(&amp;label);
00148                 vBoxLayout.addWidget(&amp;dataTable);
00149                 vBoxLayout.addWidget(&amp;buttonGroup);
00150                 vBoxLayout.addSpacing(10);
00151                 vBoxLayout.addWidget(&amp;okCancelWidget);
00152 
00153                 <span class="keywordflow">if</span>(dialog.exec())
00154                 {
00155                     <span class="keywordflow">if</span>(headerButton.isChecked())
00156                         skipFirst = <span class="keyword">true</span>;
00157                 }
00158                 <span class="keywordflow">else</span>
00159                 {
00160                     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00161                 }
00162             }
00163 
00164             file.reset();
00165             <span class="keywordflow">if</span>(skipFirst)
00166                 in.readLine();  <span class="comment">// throw-away line</span>
00167 
00168             <span class="keywordflow">if</span>(cat == <a class="code" href="classImportExport.html#w2w0">Accounts</a>)
00169             {
00170                 <a class="code" href="classAccountsData.html">AccountsData</a> *accountsData = <a class="code" href="classAccountsData.html#e0">AccountsData::instance</a>();
00171                 accountsData-&gt;<a class="code" href="classAccountsData.html#a18">importCSV</a>(in);
00172             }
00173             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cat == <a class="code" href="classImportExport.html#w2w1">JournalTmp</a>)
00174             {
00175                 <a class="code" href="classJournalData.html">JournalData</a> *journalData = <a class="code" href="classJournalData.html#e0">JournalData::instance</a>();
00176                 journalData-&gt;<a class="code" href="classJournalData.html#a19">importCSV</a>(in);
00177             }
00178 
00179             <span class="keywordflow">return</span> <span class="keyword">true</span>;
00180         }
00181 
00182         <span class="keywordflow">return</span> <span class="keyword">false</span>;
00183     }
00184 
00185     <span class="keywordflow">return</span> <span class="keyword">false</span>;
00186 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="e1" doxytag="ImportExport::exportCSV" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ImportExport::exportCSV </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="el" href="classImportExport.html#w2">ImportExport::DataCategory</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>cat</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Export data from a table to CSV. 
<p>

<p>
Definition at line <a class="el" href="importExport_8cpp-source.html#l00188">188</a> of file <a class="el" href="importExport_8cpp-source.html">importExport.cpp</a>.
<p>
References <a class="el" href="classImportExport.html#w2w0">Accounts</a>, <a class="el" href="journalData_8cpp-source.html#l00434">JournalData::exportCSV()</a>, <a class="el" href="accountsData_8cpp-source.html#l00340">AccountsData::exportCSV()</a>, <a class="el" href="settings_8cpp-source.html#l00149">Settings::getExportPath()</a>, <a class="el" href="journalData_8cpp-source.html#l00037">JournalData::instance()</a>, <a class="el" href="accountsData_8cpp-source.html#l00035">AccountsData::instance()</a>, <a class="el" href="settings_8cpp-source.html#l00126">Settings::instance()</a>, <a class="el" href="classImportExport.html#w2w1">JournalTmp</a>, <a class="el" href="importExport_8cpp-source.html#l00281">overwriteDialog()</a>, and <a class="el" href="settings_8cpp-source.html#l00154">Settings::setExportPath()</a>.
<p>
Referenced by <a class="el" href="reportsTab_8cpp-source.html#l00779">ReportsTab::exportCSV()</a>, <a class="el" href="journalTab_8cpp-source.html#l00131">JournalTab::exportCSV()</a>, <a class="el" href="importExport_8cpp-source.html#l00234">exportCSV()</a>, and <a class="el" href="accountsTab_8cpp-source.html#l00105">AccountsTab::exportCSV()</a>.
<p>
<div class="fragment"><pre>00189 {
00190     <a class="code" href="classSettings.html">Settings</a> *settings = <a class="code" href="classSettings.html#e0">Settings::instance</a>();
00191 
00192     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> fileName = QFileDialog::getSaveFileName(
00193                     settings-&gt;<a class="code" href="classSettings.html#a3">getExportPath</a>(),
00194                     <span class="stringliteral">"Comma Separated Values (*.*)"</span>,
00195                     0, <span class="stringliteral">"importExport::export_file_dialog"</span>,
00196                     <span class="stringliteral">"Export CSV Data"</span>);
00197 
00198     <span class="keywordflow">if</span>(fileName != QString::null)
00199     {
00200         <span class="keywordtype">int</span> dirPos = fileName.findRev(<span class="stringliteral">"/"</span>);
00201         <span class="keywordflow">if</span>(dirPos == -1)
00202             dirPos = fileName.findRev(<span class="stringliteral">"\\"</span>);
00203 
00204         settings-&gt;<a class="code" href="classSettings.html#a4">setExportPath</a>(fileName.left(dirPos));
00205 
00206         <a class="codeRef" doxygen="doxy-qt.tag:" href="qfile.html">QFile</a> file(fileName);
00207 
00208         <span class="keywordflow">if</span>(file.exists())
00209         {
00210             <span class="keywordflow">if</span>(!<a class="code" href="classImportExport.html#h0">overwriteDialog</a>())
00211             {
00212                 <span class="keywordflow">return</span> <a class="code" href="classImportExport.html#e1">exportCSV</a>(cat);
00213             }
00214         }
00215         <span class="keywordflow">if</span>(file.open(IO_WriteOnly))
00216         {
00217             <a class="codeRef" doxygen="doxy-qt.tag:" href="qtextstream.html">QTextStream</a> out(&amp;file);
00218             out.setEncoding(QTextStream::Locale);
00219 
00220             <span class="keywordflow">if</span>(cat == <a class="code" href="classImportExport.html#w2w0">Accounts</a>)
00221             {
00222                 <a class="code" href="classAccountsData.html">AccountsData</a> *accountsData = <a class="code" href="classAccountsData.html#e0">AccountsData::instance</a>();
00223                 accountsData-&gt;<a class="code" href="classAccountsData.html#a19">exportCSV</a>(out);
00224             }
00225             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(cat == <a class="code" href="classImportExport.html#w2w1">JournalTmp</a>)
00226             {
00227                 <a class="code" href="classJournalData.html">JournalData</a> *journalData = <a class="code" href="classJournalData.html#e0">JournalData::instance</a>();
00228                 journalData-&gt;<a class="code" href="classJournalData.html#a20">exportCSV</a>(out);
00229             }
00230         }
00231     }
00232 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="e2" doxytag="ImportExport::exportCSV" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ImportExport::exportCSV </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="elRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a>&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>data</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Export a CSV string (ie, a report in CSV form). 
<p>

<p>
Definition at line <a class="el" href="importExport_8cpp-source.html#l00234">234</a> of file <a class="el" href="importExport_8cpp-source.html">importExport.cpp</a>.
<p>
References <a class="el" href="importExport_8cpp-source.html#l00188">exportCSV()</a>, <a class="el" href="settings_8cpp-source.html#l00149">Settings::getExportPath()</a>, <a class="el" href="settings_8cpp-source.html#l00126">Settings::instance()</a>, <a class="el" href="importExport_8cpp-source.html#l00281">overwriteDialog()</a>, and <a class="el" href="settings_8cpp-source.html#l00154">Settings::setExportPath()</a>.
<p>
<div class="fragment"><pre>00235 {
00236     <a class="code" href="classSettings.html">Settings</a> *settings = <a class="code" href="classSettings.html#e0">Settings::instance</a>();
00237 
00238     <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> fileName = QFileDialog::getSaveFileName(
00239                     settings-&gt;<a class="code" href="classSettings.html#a3">getExportPath</a>(),
00240                     <span class="stringliteral">"Comma Separated Values (*.*)"</span>,
00241                     0, <span class="stringliteral">"importExport::export_file_dialog"</span>,
00242                     <span class="stringliteral">"Export CSV Data"</span>);
00243 
00244     <span class="keywordflow">if</span>(fileName != QString::null)
00245     {
00246         <span class="keywordtype">int</span> dirPos = fileName.findRev(<span class="stringliteral">"/"</span>);
00247         <span class="keywordflow">if</span>(dirPos == -1)
00248             dirPos = fileName.findRev(<span class="stringliteral">"\\"</span>);
00249 
00250         settings-&gt;<a class="code" href="classSettings.html#a4">setExportPath</a>(fileName.left(dirPos));
00251 
00252         <a class="codeRef" doxygen="doxy-qt.tag:" href="qfile.html">QFile</a> file(fileName);
00253 
00254         <span class="keywordflow">if</span>(file.exists())
00255         {
00256             <span class="keywordflow">if</span>(!<a class="code" href="classImportExport.html#h0">overwriteDialog</a>())
00257             {
00258                 <span class="keywordflow">return</span> <a class="code" href="classImportExport.html#e1">exportCSV</a>(data);
00259             }
00260         }
00261         <span class="keywordflow">if</span>(file.open(IO_WriteOnly))
00262         {
00263             <a class="codeRef" doxygen="doxy-qt.tag:" href="qtextstream.html">QTextStream</a> out(&amp;file);
00264             out.setEncoding(QTextStream::Locale);
00265 
00266             out &lt;&lt; data;
00267         }
00268         file.close();
00269     }
00270 }
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="e3" doxytag="ImportExport::exportPDF" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> void ImportExport::exportPDF </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const <a class="elRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> &amp;&nbsp;</td>
          <td class="mdname1" valign="top" nowrap> <em>text</em>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="importExport_8cpp-source.html#l00272">272</a> of file <a class="el" href="importExport_8cpp-source.html">importExport.cpp</a>.
<p>
Referenced by <a class="el" href="reportsTab_8cpp-source.html#l00732">ReportsTab::exportPDF()</a>.
<p>
<div class="fragment"><pre>00273 {}
</pre></div>    </td>
  </tr>
</table>
<a class="anchor" name="h0" doxytag="ImportExport::overwriteDialog" ></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> bool ImportExport::overwriteDialog </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="mdname1" valign="top" nowrap>          </td>
          <td class="md" valign="top">&nbsp;)&nbsp;</td>
          <td class="md" nowrap><code> [static, private]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>

<p>
Definition at line <a class="el" href="importExport_8cpp-source.html#l00281">281</a> of file <a class="el" href="importExport_8cpp-source.html">importExport.cpp</a>.
<p>
Referenced by <a class="el" href="importExport_8cpp-source.html#l00188">exportCSV()</a>.
<p>
<div class="fragment"><pre>00282 {
00283     <a class="codeRef" doxygen="doxy-qt.tag:" href="qdialog.html">QDialog</a> *dialog  = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qdialog.html">QDialog</a>(0, <span class="stringliteral">"importExport::dialog"</span>);
00284     dialog-&gt;setCaption(<span class="stringliteral">"File Exists"</span>);
00285 
00286     <a class="codeRef" doxygen="doxy-qt.tag:" href="qvboxlayout.html">QVBoxLayout</a> *vBoxLayout = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qvboxlayout.html">QVBoxLayout</a>(dialog, 5, 5,
00287         <span class="stringliteral">"importExport::vBoxLayout"</span>);
00288 
00289     <a class="codeRef" doxygen="doxy-qt.tag:" href="qlabel.html">QLabel</a> *label = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qlabel.html">QLabel</a>(<span class="stringliteral">"&lt;nobr&gt;The file you chose already exists.&lt;/nobr&gt;&lt;br&gt;"</span>
00290         <span class="stringliteral">"&lt;nobr&gt;Would you like to overwrite this file?&lt;/nobr&gt;"</span>, dialog,
00291         <span class="stringliteral">"importExport::label"</span>);
00292     vBoxLayout-&gt;addWidget(label);
00293 
00294     vBoxLayout-&gt;addSpacing(10);
00295 
00296     <a class="codeRef" doxygen="doxy-qt.tag:" href="qhboxlayout.html">QHBoxLayout</a> *hBoxLayout = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qhboxlayout.html">QHBoxLayout</a>(vBoxLayout, 5,
00297         <span class="stringliteral">"importExport::hBoxLayout"</span>);
00298 
00299     <a class="codeRef" doxygen="doxy-qt.tag:" href="qpushbutton.html">QPushButton</a> *overwriteButton = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qpushbutton.html">QPushButton</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qiconset.html">QIconSet</a>(
00300         QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/deleteButton.png"</span>)),
00301         <span class="stringliteral">"Overwrite"</span>, dialog, <span class="stringliteral">"importExport::overwriteButton"</span>);
00302     connect(overwriteButton, SIGNAL(clicked()), dialog, SLOT(accept()));
00303     overwriteButton-&gt;setDefault(<span class="keyword">false</span>);
00304 
00305     QPushButton *cancelButton = <span class="keyword">new</span> QPushButton(<a class="codeRef" doxygen="doxy-qt.tag:" href="qiconset.html">QIconSet</a>(
00306         QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/cancelButton.png"</span>)),
00307         <span class="stringliteral">"Cancel"</span>, dialog, <span class="stringliteral">"importExport::cancelButton"</span>);
00308     connect(cancelButton, SIGNAL(clicked()), dialog, SLOT(reject()));
00309     cancelButton-&gt;setDefault(<span class="keyword">true</span>);
00310 
00311     hBoxLayout-&gt;addStretch();
00312     hBoxLayout-&gt;addWidget(overwriteButton);
00313     hBoxLayout-&gt;addWidget(cancelButton);
00314 
00315     <span class="keywordtype">bool</span> retVal = dialog-&gt;exec();
00316     <span class="keyword">delete</span> dialog;
00317     <span class="keywordflow">return</span> retVal;
00318 }
</pre></div>    </td>
  </tr>
</table>
<hr>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="importExport_8h-source.html">importExport.h</a><li><a class="el" href="importExport_8cpp-source.html">importExport.cpp</a></ul>
<hr size="1"><address style="align: right;"><small>Generated on Sun Jan 16 16:23:30 2005 for General Ledger by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
