<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>General Ledger: reportsEditor.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.6 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>reportsEditor.cpp</h1><a href="reportsEditor_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/* General Ledger, Copyright (C) 2004  Joshua Eckroth &lt;josh@eckroth.net&gt;</span>
00002 <span class="comment"> * http://www.eckroth.net/software/genledg</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> * This program is free software; you can redistribute it and/or modify</span>
00005 <span class="comment"> * it under the terms of the GNU General Public License as published by</span>
00006 <span class="comment"> * the Free Software Foundation; either version 2 of the License, or</span>
00007 <span class="comment"> * (at your option) any later version.</span>
00008 <span class="comment"> * </span>
00009 <span class="comment"> * This program is distributed in the hope that it will be useful,</span>
00010 <span class="comment"> * but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00011 <span class="comment"> * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00012 <span class="comment"> * GNU General Public License for more details.</span>
00013 <span class="comment"> * </span>
00014 <span class="comment"> * You should have received a copy of the GNU General Public License</span>
00015 <span class="comment"> * along with this program; if not, write to the Free Software</span>
00016 <span class="comment"> * Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  US</span>
00017 <span class="comment">*/</span>
00018 
00019 <span class="preprocessor">#include &lt;vector&gt;</span>
00020 <span class="keyword">using</span> std::vector;
00021 
00022 <span class="preprocessor">#include &lt;qwidget.h&gt;</span>
00023 <span class="preprocessor">#include &lt;qstring.h&gt;</span>
00024 <span class="preprocessor">#include &lt;qiodevice.h&gt;</span>
00025 <span class="preprocessor">#include &lt;qdatastream.h&gt;</span>
00026 <span class="preprocessor">#include &lt;qscrollview.h&gt;</span>
00027 <span class="preprocessor">#include &lt;qlayout.h&gt;</span>
00028 
00029 <span class="preprocessor">#include "<a class="code" href="reportsEditor_8h.html">reportsEditor.h</a>"</span>
00030 <span class="preprocessor">#include "<a class="code" href="reportsEditorSection_8h.html">reportsEditorSection.h</a>"</span>
00031 
<a name="l00032"></a><a class="code" href="classReportsEditor.html#v0">00032</a> <a class="code" href="classReportsEditor.html">ReportsEditor</a> *<a class="code" href="classReportsEditor.html#v0">ReportsEditor::thisInstance</a> = 0;
00033 
<a name="l00034"></a><a class="code" href="classReportsEditor.html#e0">00034</a> <a class="code" href="classReportsEditor.html">ReportsEditor</a>* <a class="code" href="classReportsEditor.html#e0">ReportsEditor::instance</a>()
00035 {
00036     <span class="keywordflow">if</span>(<a class="code" href="classReportsEditor.html#v0">thisInstance</a> == 0)
00037         <a class="code" href="classReportsEditor.html#v0">thisInstance</a> = <span class="keyword">new</span> <a class="code" href="classReportsEditor.html">ReportsEditor</a>;
00038     <span class="keywordflow">return</span> <a class="code" href="classReportsEditor.html#v0">thisInstance</a>;
00039 }
00040 
<a name="l00041"></a><a class="code" href="classReportsEditor.html#a0">00041</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditor.html#a0">ReportsEditor::destroy</a>()
00042 {
00043     <span class="keywordflow">if</span>(<a class="code" href="classReportsEditor.html#v0">thisInstance</a> != 0)
00044         <span class="keyword">delete</span> <a class="code" href="classReportsEditor.html#v0">thisInstance</a>;
00045 }
00046 
<a name="l00047"></a><a class="code" href="classReportsEditor.html#a1">00047</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditor.html#a1">ReportsEditor::initiate</a>()
00048 {}
00049 
<a name="l00050"></a><a class="code" href="classReportsEditor.html#a2">00050</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditor.html#a2">ReportsEditor::readStream</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qiodevice.html">QIODevice</a> *device, Q_UINT16 editorEntityCount)
00051 {
00052     <a class="codeRef" doxygen="doxy-qt.tag:" href="qdatastream.html">QDataStream</a> in(device);
00053 
00054     Q_UINT16 entityCount = 0;
00055     <span class="keywordflow">while</span>(entityCount++ != editorEntityCount)
00056     {
00057         <a class="code" href="structReportsEditor_1_1Entity.html">Entity</a> *entity = <span class="keyword">new</span> <a class="code" href="structReportsEditor_1_1Entity.html">Entity</a>;
00058         in &gt;&gt; entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o0">editor</a>
00059            &gt;&gt; entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o1">section</a>
00060            &gt;&gt; entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o2">index</a>
00061            &gt;&gt; entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o3">accountBegin</a>
00062            &gt;&gt; entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o4">accountEnd</a>
00063            &gt;&gt; entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o5">desc</a>;
00064         <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.push_back(entity);
00065     }
00066 }
00067 
<a name="l00068"></a><a class="code" href="classReportsEditor.html#a3">00068</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditor.html#a3">ReportsEditor::writeStream</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qiodevice.html">QIODevice</a> *device)
00069 {
00070     <a class="codeRef" doxygen="doxy-qt.tag:" href="qdatastream.html">QDataStream</a> out(device);
00071 
00072     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00073                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00074     {
00075         <span class="keywordflow">if</span>((*it) != 0)
00076         {
00077             out &lt;&lt; (*it)-&gt;editor
00078                 &lt;&lt; (*it)-&gt;section
00079                 &lt;&lt; (*it)-&gt;index
00080                 &lt;&lt; (*it)-&gt;accountBegin
00081                 &lt;&lt; (*it)-&gt;accountEnd
00082                 &lt;&lt; (*it)-&gt;desc;
00083         }
00084     }
00085 }
00086 
<a name="l00087"></a><a class="code" href="classReportsEditor.html#a4">00087</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditor.html#a4">ReportsEditor::clearData</a>()
00088 {
00089     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00090         it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00091     {
00092         <span class="keywordflow">if</span>((*it) != 0)
00093             <span class="keyword">delete</span> (*it);
00094     }
00095 
00096     <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.clear();
00097 }
00098 
<a name="l00099"></a><a class="code" href="classReportsEditor.html#a5">00099</a> Q_UINT16 <a class="code" href="classReportsEditor.html#a5">ReportsEditor::getEditorEntityCount</a>()<span class="keyword"> const</span>
00100 <span class="keyword"></span>{
00101     Q_UINT16 count = 0;
00102     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00103                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00104     {
00105         <span class="keywordflow">if</span>((*it) != 0)
00106             count++;
00107     }
00108 
00109     <span class="keywordflow">return</span> count;
00110 }
00111 
<a name="l00112"></a><a class="code" href="classReportsEditor.html#a6">00112</a> <a class="codeRef" doxygen="doxy-qt.tag:" href="qwidget.html">QWidget</a>* <a class="code" href="classReportsEditor.html#a6">ReportsEditor::createEditor</a>(<a class="codeRef" doxygen="doxy-qt.tag:" href="qwidget.html">QWidget</a> *parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name,
00113                 ReportsEditor::Editor editor)
00114 {
00115     <a class="codeRef" doxygen="doxy-qt.tag:" href="qscrollview.html">QScrollView</a> *scrollView = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qscrollview.html">QScrollView</a>(parent,name);
00116     scrollView-&gt;setResizePolicy(QScrollView::AutoOneFit);
00117 
00118     <a class="codeRef" doxygen="doxy-qt.tag:" href="qwidget.html">QWidget</a> *mainWidget = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qwidget.html">QWidget</a>(scrollView-&gt;viewport(),
00119                     <span class="stringliteral">"reportsEditor::mainWidget"</span>);
00120 
00121     <a class="codeRef" doxygen="doxy-qt.tag:" href="qhboxlayout.html">QHBoxLayout</a> *hBoxLayout = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qhboxlayout.html">QHBoxLayout</a>(mainWidget, 0, -1,
00122                     <span class="stringliteral">"reportsEditor::hBoxLayout"</span>);
00123     hBoxLayout-&gt;addSpacing(5);
00124     
00125     <a class="codeRef" doxygen="doxy-qt.tag:" href="qvboxlayout.html">QVBoxLayout</a> *vBoxLayout = <span class="keyword">new</span> <a class="codeRef" doxygen="doxy-qt.tag:" href="qvboxlayout.html">QVBoxLayout</a>(hBoxLayout, -1,
00126                     <span class="stringliteral">"reportsEditor::vBoxLayout"</span>);
00127     vBoxLayout-&gt;addSpacing(5);
00128 
00129     <span class="keywordflow">if</span>(editor == <a class="code" href="classReportsEditor.html#w9w0">BalanceSheet</a>)
00130     {
00131         <a class="code" href="classReportsEditorSection.html">ReportsEditorSection</a> *assets = <span class="keyword">new</span> <a class="code" href="classReportsEditorSection.html">ReportsEditorSection</a>(mainWidget,
00132                         <span class="stringliteral">"reportsEditor::assets"</span>,
00133                         <span class="stringliteral">"Assets"</span>, <a class="code" href="classReportsEditor.html#w9w0">BalanceSheet</a>, <a class="code" href="classReportsEditor.html#w10w3">Assets</a>);
00134         ReportsEditorSection *liabilities = <span class="keyword">new</span> ReportsEditorSection(mainWidget,
00135                         <span class="stringliteral">"reportsEditor::liabilities"</span>,
00136                         <span class="stringliteral">"Liabilities"</span>, <a class="code" href="classReportsEditor.html#w9w0">BalanceSheet</a>, <a class="code" href="classReportsEditor.html#w10w4">Liabilities</a>);
00137         ReportsEditorSection *equities = <span class="keyword">new</span> ReportsEditorSection(mainWidget,
00138                         <span class="stringliteral">"reportsEditor::equities"</span>,
00139                         <span class="stringliteral">"Equities"</span>, <a class="code" href="classReportsEditor.html#w9w0">BalanceSheet</a>, <a class="code" href="classReportsEditor.html#w10w5">Equities</a>);
00140 
00141         vBoxLayout-&gt;addWidget(assets);
00142         vBoxLayout-&gt;addSpacing(10);
00143         vBoxLayout-&gt;addWidget(liabilities);
00144         vBoxLayout-&gt;addSpacing(10);
00145         vBoxLayout-&gt;addWidget(equities);
00146 
00147     }
00148     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(editor == <a class="code" href="classReportsEditor.html#w9w1">IncomeSvc</a>)
00149     {
00150         <a class="code" href="classReportsEditorSection.html">ReportsEditorSection</a> *income = <span class="keyword">new</span> <a class="code" href="classReportsEditorSection.html">ReportsEditorSection</a>(mainWidget,
00151                         <span class="stringliteral">"reportsEditor::income"</span>,
00152                         <span class="stringliteral">"Income"</span>, <a class="code" href="classReportsEditor.html#w9w1">IncomeSvc</a>, <a class="code" href="classReportsEditor.html#w10w6">Income</a>);
00153         ReportsEditorSection *expenses = <span class="keyword">new</span> ReportsEditorSection(mainWidget,
00154                         <span class="stringliteral">"reportsEditor::expenses"</span>,
00155                         <span class="stringliteral">"Expenses"</span>, <a class="code" href="classReportsEditor.html#w9w1">IncomeSvc</a>, <a class="code" href="classReportsEditor.html#w10w8">Expenses</a>);
00156 
00157         vBoxLayout-&gt;addWidget(income);
00158         vBoxLayout-&gt;addSpacing(10);
00159         vBoxLayout-&gt;addWidget(expenses);
00160     }
00161     <span class="keywordflow">else</span> <span class="keywordflow">if</span>(editor == <a class="code" href="classReportsEditor.html#w9w2">IncomeRetail</a>)
00162     {
00163         <a class="code" href="classReportsEditorSection.html">ReportsEditorSection</a> *income = <span class="keyword">new</span> <a class="code" href="classReportsEditorSection.html">ReportsEditorSection</a>(mainWidget,
00164                         <span class="stringliteral">"reportsEditor::income"</span>,
00165                         <span class="stringliteral">"Income"</span>, <a class="code" href="classReportsEditor.html#w9w2">IncomeRetail</a>, <a class="code" href="classReportsEditor.html#w10w6">Income</a>);
00166         ReportsEditorSection *costOfSales = <span class="keyword">new</span> ReportsEditorSection(mainWidget,
00167                         <span class="stringliteral">"reportsEditor::costOfSales"</span>,
00168                         <span class="stringliteral">"Cost Of Sales"</span>, <a class="code" href="classReportsEditor.html#w9w2">IncomeRetail</a>, <a class="code" href="classReportsEditor.html#w10w7">CostOfSales</a>);
00169         ReportsEditorSection *expenses = <span class="keyword">new</span> ReportsEditorSection(mainWidget,
00170                         <span class="stringliteral">"reportsEditor::expenses"</span>,
00171                         <span class="stringliteral">"Expenses"</span>, <a class="code" href="classReportsEditor.html#w9w2">IncomeRetail</a>, <a class="code" href="classReportsEditor.html#w10w8">Expenses</a>);
00172 
00173         vBoxLayout-&gt;addWidget(income);
00174         vBoxLayout-&gt;addSpacing(10);
00175         vBoxLayout-&gt;addWidget(costOfSales);
00176         vBoxLayout-&gt;addSpacing(10);
00177         vBoxLayout-&gt;addWidget(expenses);
00178     }
00179 
00180     vBoxLayout-&gt;addStretch();
00181 
00182     hBoxLayout-&gt;addSpacing(5);
00183     
00184     scrollView-&gt;addChild(mainWidget);
00185 
00186     <span class="keywordflow">return</span> scrollView;
00187 }
00188 
<a name="l00189"></a><a class="code" href="classReportsEditor.html#a7">00189</a> vector&lt;ReportsEditor::Entity*&gt; <a class="code" href="classReportsEditor.html#a7">ReportsEditor::getEntities</a>(
00190                 ReportsEditor::Editor editor, ReportsEditor::Section section)
00191 {
00192     vector&lt;Entity*&gt; entitiesUnsorted;
00193     
00194     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00195                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00196     {
00197         <span class="keywordflow">if</span>((*it) != 0)
00198         {
00199             <span class="keywordflow">if</span>((*it)-&gt;editor == editor &amp;&amp; (*it)-&gt;section == section)
00200             {
00201                 entitiesUnsorted.push_back(*it);
00202             }
00203         }
00204     }
00205 
00206     vector&lt;Entity*&gt; entitiesSorted;
00207     
00208     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = entitiesUnsorted.begin();
00209                     it != entitiesUnsorted.end(); ++it)
00210     {
00211         <span class="keywordtype">bool</span> inserted = <span class="keyword">false</span>;
00212         <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::iterator innerIt = entitiesSorted.begin();
00213                         innerIt != entitiesSorted.end(); ++innerIt)
00214         {
00215             <span class="keywordflow">if</span>((*it)-&gt;index &lt; (*innerIt)-&gt;index)
00216             {
00217                 entitiesSorted.insert(innerIt, *it);
00218 
00219                 inserted = <span class="keyword">true</span>;
00220                 <span class="keywordflow">break</span>;
00221             }
00222         }
00223         
00224         <span class="keywordflow">if</span>(!inserted)
00225             entitiesSorted.push_back(*it);
00226     }
00227 
00228     <span class="keywordflow">return</span> entitiesSorted;
00229 }
00230 
<a name="l00231"></a><a class="code" href="classReportsEditor.html#a8">00231</a> <span class="keywordtype">bool</span> <a class="code" href="classReportsEditor.html#a8">ReportsEditor::entityExists</a>(
00232                 ReportsEditor::Editor editor, ReportsEditor::Section section,
00233                 <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> accountBegin, <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> accountEnd, <a class="codeRef" doxygen="doxy-qt.tag:" href="qstring.html">QString</a> desc)
00234 {
00235     <span class="keywordtype">bool</span> exists = <span class="keyword">false</span>;
00236     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00237                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00238     {
00239         <span class="keywordflow">if</span>((*it) != 0)
00240         {
00241             <span class="keywordflow">if</span>((*it)-&gt;editor == editor &amp;&amp; (*it)-&gt;section == section
00242                &amp;&amp; (*it)-&gt;accountBegin == accountBegin
00243                &amp;&amp; (*it)-&gt;accountEnd == accountEnd
00244                &amp;&amp; (*it)-&gt;desc == desc)
00245             {
00246                 exists = <span class="keyword">true</span>;
00247                 <span class="keywordflow">break</span>;
00248             }
00249         }
00250     }
00251 
00252     <span class="keywordflow">return</span> exists;
00253 }
00254 
<a name="l00255"></a><a class="code" href="classReportsEditor.html#a9">00255</a> Q_UINT16 <a class="code" href="classReportsEditor.html#a9">ReportsEditor::getFirstIndex</a>(
00256                 ReportsEditor::Editor editor, ReportsEditor::Section section)
00257 {
00258     Q_UINT16 index = <a class="code" href="classReportsEditor.html#a10">getLastIndex</a>(editor, section);
00259     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00260                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00261     {
00262         <span class="keywordflow">if</span>((*it) != 0)
00263         {
00264             <span class="keywordflow">if</span>((*it)-&gt;editor == editor &amp;&amp; (*it)-&gt;section == section
00265                             &amp;&amp; (*it)-&gt;index &lt; index)
00266             {
00267                 index = (*it)-&gt;index;
00268             }
00269         }
00270     }
00271 
00272     <span class="keywordflow">return</span> index;
00273 }
00274 
00275 
<a name="l00276"></a><a class="code" href="classReportsEditor.html#a10">00276</a> Q_UINT16 <a class="code" href="classReportsEditor.html#a10">ReportsEditor::getLastIndex</a>(
00277                 ReportsEditor::Editor editor, ReportsEditor::Section section)
00278 {
00279     Q_UINT16 index = 0;
00280     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00281                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00282     {
00283         <span class="keywordflow">if</span>((*it) != 0)
00284         {
00285             <span class="keywordflow">if</span>((*it)-&gt;editor == editor &amp;&amp; (*it)-&gt;section == section
00286                             &amp;&amp; (*it)-&gt;index &gt; index)
00287             {
00288                 index = (*it)-&gt;index;
00289             }
00290         }
00291     }
00292 
00293     <span class="keywordflow">return</span> index;
00294 }
00295 
<a name="l00296"></a><a class="code" href="classReportsEditor.html#a11">00296</a> Q_UINT16 <a class="code" href="classReportsEditor.html#a11">ReportsEditor::getNextIndex</a>(
00297                 ReportsEditor::Editor editor, ReportsEditor::Section section)
00298 {
00299     <span class="keywordflow">return</span> (<a class="code" href="classReportsEditor.html#a10">getLastIndex</a>(editor,section) + 1);
00300 }
00301 
<a name="l00302"></a><a class="code" href="classReportsEditor.html#a12">00302</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditor.html#a12">ReportsEditor::moveEntityUp</a>(<a class="code" href="structReportsEditor_1_1Entity.html">ReportsEditor::Entity</a> *entity)
00303 {
00304     Q_UINT16 before = <a class="code" href="classReportsEditor.html#a9">getFirstIndex</a>((<a class="code" href="classReportsEditor.html#w9">Editor</a>)(entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o0">editor</a>),
00305                     (<a class="code" href="classReportsEditor.html#w10">Section</a>)(entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o1">section</a>));
00306 
00307     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00308                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00309     {
00310         <span class="keywordflow">if</span>((*it) != 0)
00311         {
00312             <span class="keywordflow">if</span>((*it)-&gt;editor == entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o0">editor</a>
00313                &amp;&amp; (*it)-&gt;section == entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o1">section</a>)
00314             {
00315                 <span class="keywordflow">if</span>((*it)-&gt;index &lt; entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o2">index</a> &amp;&amp; (*it)-&gt;index &gt; before)
00316                 {
00317                     before = (*it)-&gt;index;
00318                 }
00319             }
00320         }
00321     }
00322 
00323     Q_UINT16 entityIndex = entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o2">index</a>;
00324 
00325     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00326                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00327     {
00328         <span class="keywordflow">if</span>((*it) != 0)
00329         {
00330             <span class="keywordflow">if</span>((*it)-&gt;editor == entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o0">editor</a>
00331                &amp;&amp; (*it)-&gt;section == entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o1">section</a>)
00332             {
00333                 <span class="keywordflow">if</span>((*it)-&gt;index == before &amp;&amp; (*it) != entity)
00334                 {
00335                     (*it)-&gt;index = entityIndex;
00336                 }
00337                 <span class="keywordflow">if</span>((*it) == entity)
00338                 {
00339                     (*it)-&gt;index = before;
00340                 }
00341             }
00342         }
00343     }
00344 
00345     emit <a class="code" href="classReportsEditor.html#l0">saveToDisk</a>();
00346 }
00347 
<a name="l00348"></a><a class="code" href="classReportsEditor.html#a13">00348</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditor.html#a13">ReportsEditor::moveEntityDown</a>(<a class="code" href="structReportsEditor_1_1Entity.html">ReportsEditor::Entity</a> *entity)
00349 {
00350     Q_UINT16 after = <a class="code" href="classReportsEditor.html#a10">getLastIndex</a>((<a class="code" href="classReportsEditor.html#w9">Editor</a>)(entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o0">editor</a>),
00351                     (<a class="code" href="classReportsEditor.html#w10">Section</a>)(entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o1">section</a>));
00352 
00353     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00354                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00355     {
00356         <span class="keywordflow">if</span>((*it) != 0)
00357         {
00358             <span class="keywordflow">if</span>((*it)-&gt;editor == entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o0">editor</a>
00359                &amp;&amp; (*it)-&gt;section == entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o1">section</a>)
00360             {
00361                 <span class="keywordflow">if</span>((*it)-&gt;index &gt; entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o2">index</a> &amp;&amp; (*it)-&gt;index &lt; after)
00362                 {
00363                     after = (*it)-&gt;index;
00364                 }
00365             }
00366         }
00367     }
00368 
00369     Q_UINT16 entityIndex = entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o2">index</a>;
00370 
00371     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::const_iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00372                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00373     {
00374         <span class="keywordflow">if</span>((*it) != 0)
00375         {
00376             <span class="keywordflow">if</span>((*it)-&gt;editor == entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o0">editor</a>
00377                &amp;&amp; (*it)-&gt;section == entity-&gt;<a class="code" href="structReportsEditor_1_1Entity.html#o1">section</a>)
00378             {
00379                 <span class="keywordflow">if</span>((*it)-&gt;index == after &amp;&amp; (*it) != entity)
00380                 {
00381                     (*it)-&gt;index = entityIndex;
00382                 }
00383                 <span class="keywordflow">if</span>(*it == entity)
00384                 {
00385                     (*it)-&gt;index = after;
00386                 }
00387             }
00388         }
00389     }
00390 
00391     emit <a class="code" href="classReportsEditor.html#l0">saveToDisk</a>();
00392 }
00393 
<a name="l00394"></a><a class="code" href="classReportsEditor.html#a14">00394</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditor.html#a14">ReportsEditor::addEntity</a>(<a class="code" href="structReportsEditor_1_1Entity.html">ReportsEditor::Entity</a> *entity)
00395 {
00396     <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.push_back(entity);
00397 
00398     emit <a class="code" href="classReportsEditor.html#l0">saveToDisk</a>();
00399 }
00400 
<a name="l00401"></a><a class="code" href="classReportsEditor.html#a15">00401</a> <span class="keywordtype">void</span> <a class="code" href="classReportsEditor.html#a15">ReportsEditor::removeEntity</a>(<a class="code" href="structReportsEditor_1_1Entity.html">ReportsEditor::Entity</a> *entity)
00402 {
00403     <span class="keywordflow">for</span>(vector&lt;Entity*&gt;::iterator it = <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.begin();
00404                     it != <a class="code" href="classReportsEditor.html#r0">editorEntities</a>.end(); ++it)
00405     {
00406         <span class="keywordflow">if</span>(*it == entity)
00407         {
00408             *it = 0;
00409             <span class="keyword">delete</span> entity;
00410         }
00411     }
00412 
00413     emit <a class="code" href="classReportsEditor.html#l0">saveToDisk</a>();
00414 }
00415 
00416 
00417 <span class="comment">// Private</span>
00418 
<a name="l00419"></a><a class="code" href="classReportsEditor.html#d0">00419</a> <a class="code" href="classReportsEditor.html#d0">ReportsEditor::ReportsEditor</a>() : <a class="codeRef" doxygen="doxy-qt.tag:" href="qobject.html">QObject</a>(0, "<a class="code" href="classReportsEditor.html">ReportsEditor</a>")
00420 {}
00421 
<a name="l00422"></a><a class="code" href="classReportsEditor.html#d1">00422</a> <a class="code" href="classReportsEditor.html#d1">ReportsEditor::~ReportsEditor</a>()
00423 {}
00424 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Sun Jan 16 16:23:28 2005 for General Ledger by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.6 </small></address>
</body>
</html>
