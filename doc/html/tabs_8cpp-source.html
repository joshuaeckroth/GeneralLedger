<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>General Ledger: tabs.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>tabs.cpp</h1><a href="tabs_8cpp.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="preprocessor">#include &lt;qtabwidget.h&gt;</span>
00002 <span class="preprocessor">#include &lt;qapplication.h&gt;</span>
00003 
00004 <span class="preprocessor">#include "config.h"</span>
00005 <span class="preprocessor">#include "<a class="code" href="database_8h.html">database.h</a>"</span>
00006 <span class="preprocessor">#include "<a class="code" href="settings_8h.html">settings.h</a>"</span>
00007 <span class="preprocessor">#include "<a class="code" href="tabs_8h.html">tabs.h</a>"</span>
00008 <span class="preprocessor">#include "<a class="code" href="mainStack_8h.html">mainStack.h</a>"</span>
00009 <span class="preprocessor">#include "<a class="code" href="accountStack_8h.html">accountStack.h</a>"</span>
00010 <span class="preprocessor">#include "<a class="code" href="journalStack_8h.html">journalStack.h</a>"</span>
00011 <span class="preprocessor">#include "<a class="code" href="reportStack_8h.html">reportStack.h</a>"</span>
00012 <span class="preprocessor">#include "<a class="code" href="helpStack_8h.html">helpStack.h</a>"</span>
00013 
<a name="l00014"></a><a class="code" href="classTabs.html#a0">00014</a> <a class="code" href="classTabs.html#a0">Tabs::Tabs</a>(QApplication *parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name)
00015     : QTabWidget(0,name)
00016 {
00017     <a class="code" href="classTabs.html#r0">db</a> = <a class="code" href="classDatabase.html#e0">Database::instance</a>();
00018     <a class="code" href="classTabs.html#r1">settings</a> = <a class="code" href="classSettings.html#e0">Settings::instance</a>();
00019 
00020     <a class="code" href="classTabs.html#r2">app</a> = parent;
00021     
00022     setFocusPolicy(QWidget::NoFocus);
00023     
00024     setCaption(<span class="stringliteral">"General Ledger"</span>);
00025     
00026     <a class="code" href="classTabs.html#r3">mainStack</a> = <span class="keyword">new</span> <a class="code" href="classMainStack.html">MainStack</a>;
00027     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(<a class="code" href="classTabs.html#k0">dbOpened</a>()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k0">dbOpened</a>()));
00028     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(<a class="code" href="classTabs.html#k4">switchToAccounts</a>()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k4">switchToAccounts</a>()));
00029     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(<a class="code" href="classTabs.html#k5">switchToJournal</a>()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k5">switchToJournal</a>()));
00030     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(<a class="code" href="classTabs.html#k6">switchToReports</a>()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k6">switchToReports</a>()));
00031     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(<a class="code" href="classTabs.html#k1">dbClosed</a>()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k1">dbClosed</a>()));
00032     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(<a class="code" href="classTabs.html#k2">nameChanged</a>()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k2">nameChanged</a>()));
00033     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(<a class="code" href="classTabs.html#k8">quit</a>()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k8">quit</a>()));
00034     
00035     <a class="code" href="classTabs.html#r4">accountStack</a> = <span class="keyword">new</span> <a class="code" href="classAccountStack.html">AccountStack</a>;
00036     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(<a class="code" href="classTabs.html#k0">dbOpened</a>()), <a class="code" href="classTabs.html#r4">accountStack</a>, SLOT(<a class="code" href="classTabs.html#k0">dbOpened</a>()));
00037     connect(<a class="code" href="classTabs.html#r4">accountStack</a>, SIGNAL(goToMain()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k3">switchToMain</a>()));
00038     connect(<a class="code" href="classTabs.html#r4">accountStack</a>, SIGNAL(goToJournal()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k5">switchToJournal</a>()));
00039     connect(<a class="code" href="classTabs.html#r4">accountStack</a>, SIGNAL(goToReports()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k6">switchToReports</a>()));
00040     connect(<a class="code" href="classTabs.html#r4">accountStack</a>, SIGNAL(goToHelp()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k7">switchToHelp</a>()));
00041     
00042     <a class="code" href="classTabs.html#r5">journalStack</a> = <span class="keyword">new</span> <a class="code" href="classJournalStack.html">JournalStack</a>;
00043     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(<a class="code" href="classTabs.html#k0">dbOpened</a>()), <a class="code" href="classTabs.html#r5">journalStack</a>, SLOT(<a class="code" href="classTabs.html#k0">dbOpened</a>()));
00044     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(saveAndClearJournalTmp()), <a class="code" href="classTabs.html#r5">journalStack</a>, SLOT(saveAndClear()));
00045     connect(<a class="code" href="classTabs.html#r5">journalStack</a>, SIGNAL(goToMain()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k3">switchToMain</a>()));
00046     connect(<a class="code" href="classTabs.html#r5">journalStack</a>, SIGNAL(goToAccounts()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k4">switchToAccounts</a>()));
00047     connect(<a class="code" href="classTabs.html#r5">journalStack</a>, SIGNAL(goToReports()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k6">switchToReports</a>()));
00048     connect(<a class="code" href="classTabs.html#r5">journalStack</a>, SIGNAL(goToHelp()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k7">switchToHelp</a>()));
00049     
00050     <a class="code" href="classTabs.html#r6">reportStack</a> = <span class="keyword">new</span> <a class="code" href="classReportStack.html">ReportStack</a>;
00051     connect(<a class="code" href="classTabs.html#r3">mainStack</a>, SIGNAL(<a class="code" href="classTabs.html#k0">dbOpened</a>()), <a class="code" href="classTabs.html#r6">reportStack</a>, SLOT(<a class="code" href="classTabs.html#k0">dbOpened</a>()));
00052     connect(<a class="code" href="classTabs.html#r6">reportStack</a>, SIGNAL(goToMain()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k3">switchToMain</a>()));
00053     
00054     <a class="code" href="classTabs.html#r7">helpStack</a> = <span class="keyword">new</span> <a class="code" href="classHelpStack.html">HelpStack</a>;
00055     connect(<a class="code" href="classTabs.html#r7">helpStack</a>, SIGNAL(goToMain()), <span class="keyword">this</span>, SLOT(<a class="code" href="classTabs.html#k3">switchToMain</a>()));
00056     
00057     addTab( <a class="code" href="classTabs.html#r3">mainStack</a>, QIconSet( QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/mainTab.png"</span>) ), <span class="stringliteral">"Main (F1)"</span> );
00058     addTab( <a class="code" href="classTabs.html#r4">accountStack</a>, QIconSet( QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/accountsTab.png"</span>) ), <span class="stringliteral">"Accounts (F2)"</span> );
00059     setTabEnabled(<a class="code" href="classTabs.html#r4">accountStack</a>, 0);
00060     addTab( <a class="code" href="classTabs.html#r5">journalStack</a>, QIconSet( QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/journalTab.png"</span>) ), <span class="stringliteral">"Journal Entry (F3)"</span> );
00061     setTabEnabled(<a class="code" href="classTabs.html#r5">journalStack</a>, 0);
00062     addTab( <a class="code" href="classTabs.html#r6">reportStack</a>, QIconSet( QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/reportTab.png"</span>) ), <span class="stringliteral">"Reports (F4)"</span> );
00063     setTabEnabled(<a class="code" href="classTabs.html#r6">reportStack</a>, 0);
00064     addTab( <a class="code" href="classTabs.html#r7">helpStack</a>, QIconSet( QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/help.png"</span>) ), <span class="stringliteral">"Help (F5)"</span> );
00065 
00066 
00067     <span class="keywordflow">if</span>(<a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a15">getDefaultX</a>() == 10000 &amp;&amp; <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a17">getDefaultY</a>() == 10000 
00068        &amp;&amp; <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a11">getDefaultWidth</a>() == 10000 &amp;&amp; <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a13">getDefaultHeight</a>() == 10000)
00069         showMaximized();
00070     <span class="keywordflow">else</span>
00071     {
00072         move(<a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a15">getDefaultX</a>(), <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a17">getDefaultY</a>());
00073         resize(<a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a11">getDefaultWidth</a>(), <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a13">getDefaultHeight</a>());
00074     }
00075     
00076 }
00077 
<a name="l00078"></a><a class="code" href="classTabs.html#a1">00078</a> <a class="code" href="classTabs.html#a1">Tabs::~Tabs</a>()
00079 {}
00080 
<a name="l00081"></a><a class="code" href="classTabs.html#k0">00081</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#k0">Tabs::dbOpened</a>()
00082 {
00083     setCaption(<span class="stringliteral">"General Ledger - "</span> + <a class="code" href="classTabs.html#r0">db</a>-&gt;<a class="code" href="classDatabase.html#a11">getCurClient</a>());
00084     
00085     setTabEnabled(<a class="code" href="classTabs.html#r4">accountStack</a>, <span class="keyword">true</span>);
00086     setTabEnabled(<a class="code" href="classTabs.html#r5">journalStack</a>, <span class="keyword">true</span>);
00087     setTabEnabled(<a class="code" href="classTabs.html#r6">reportStack</a>, <span class="keyword">true</span>);
00088 }
00089 
<a name="l00090"></a><a class="code" href="classTabs.html#k1">00090</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#k1">Tabs::dbClosed</a>()
00091 {
00092     setCaption(<span class="stringliteral">"General Ledger"</span>);
00093     
00094     setTabEnabled(<a class="code" href="classTabs.html#r4">accountStack</a>, <span class="keyword">false</span>);
00095     setTabEnabled(<a class="code" href="classTabs.html#r5">journalStack</a>, <span class="keyword">false</span>);
00096     setTabEnabled(<a class="code" href="classTabs.html#r6">reportStack</a>, <span class="keyword">false</span>);
00097 }
00098 
<a name="l00099"></a><a class="code" href="classTabs.html#k2">00099</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#k2">Tabs::nameChanged</a>()
00100 {
00101     setCaption(<span class="stringliteral">"General Ledger - "</span> + <a class="code" href="classTabs.html#r0">db</a>-&gt;<a class="code" href="classDatabase.html#a11">getCurClient</a>());
00102 }
00103 
<a name="l00104"></a><a class="code" href="classTabs.html#d0">00104</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#d0">Tabs::keyPressEvent</a>(QKeyEvent *event)
00105 {
00106     <span class="keywordflow">switch</span>(event-&gt;key())
00107     {
00108         <span class="keywordflow">case</span> Key_F1:
00109             showPage(<a class="code" href="classTabs.html#r3">mainStack</a>);
00110             <span class="keywordflow">break</span>;
00111         <span class="keywordflow">case</span> Key_F2:
00112             <span class="keywordflow">if</span>(isTabEnabled(<a class="code" href="classTabs.html#r4">accountStack</a>))
00113                 showPage(<a class="code" href="classTabs.html#r4">accountStack</a>);
00114             <span class="keywordflow">break</span>;
00115         <span class="keywordflow">case</span> Key_F3:
00116             <span class="keywordflow">if</span>(isTabEnabled(<a class="code" href="classTabs.html#r5">journalStack</a>))
00117                 showPage(<a class="code" href="classTabs.html#r5">journalStack</a>);
00118             <span class="keywordflow">break</span>;
00119         <span class="keywordflow">case</span> Key_F4:
00120             <span class="keywordflow">if</span>(isTabEnabled(<a class="code" href="classTabs.html#r6">reportStack</a>))
00121                 showPage(<a class="code" href="classTabs.html#r6">reportStack</a>);
00122             <span class="keywordflow">break</span>;
00123         <span class="keywordflow">case</span> Key_F5:
00124             showPage(<a class="code" href="classTabs.html#r7">helpStack</a>);
00125             <span class="keywordflow">break</span>;
00126     }
00127 }
00128 
<a name="l00129"></a><a class="code" href="classTabs.html#d1">00129</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#d1">Tabs::closeEvent</a>(QCloseEvent *event)
00130 {
00131     <a class="code" href="classTabs.html#r3">mainStack</a>-&gt;<a class="code" href="classMainStack.html#i0">closeClient</a>();
00132     <span class="keywordflow">if</span>(<a class="code" href="classTabs.html#r3">mainStack</a>-&gt;<a class="code" href="classMainStack.html#a2">closed</a>())
00133     {
00134         <a class="code" href="classTabs.html#k8">quit</a>();
00135         event-&gt;accept();
00136     }
00137     <span class="keywordflow">else</span>
00138         event-&gt;ignore();
00139 }
00140 
<a name="l00141"></a><a class="code" href="classTabs.html#k3">00141</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#k3">Tabs::switchToMain</a>()
00142 {
00143     setCurrentPage(0);
00144 }
00145 
<a name="l00146"></a><a class="code" href="classTabs.html#k4">00146</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#k4">Tabs::switchToAccounts</a>()
00147 {
00148     setCurrentPage(1);
00149 }
00150 
<a name="l00151"></a><a class="code" href="classTabs.html#k5">00151</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#k5">Tabs::switchToJournal</a>()
00152 {
00153     setCurrentPage(2);
00154 }
00155 
<a name="l00156"></a><a class="code" href="classTabs.html#k6">00156</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#k6">Tabs::switchToReports</a>()
00157 {
00158     setCurrentPage(3);
00159 }
00160 
<a name="l00161"></a><a class="code" href="classTabs.html#k7">00161</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#k7">Tabs::switchToHelp</a>()
00162 {
00163     setCurrentPage(4);
00164 }
00165 
<a name="l00166"></a><a class="code" href="classTabs.html#k8">00166</a> <span class="keywordtype">void</span> <a class="code" href="classTabs.html#k8">Tabs::quit</a>()
00167 {
00168     <span class="keywordflow">if</span>(!isMaximized())
00169     {
00170         <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a16">setDefaultX</a>(x());
00171         <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a18">setDefaultY</a>(y());
00172         <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a12">setDefaultWidth</a>(width());
00173         <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a14">setDefaultHeight</a>(height());
00174     }
00175     <span class="keywordflow">else</span>
00176     {
00177         <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a16">setDefaultX</a>(10000);  <span class="comment">// 10000 instead of -1 because</span>
00178         <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a18">setDefaultY</a>(10000);  <span class="comment">// windows registry wasn't storing -1</span>
00179         <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a12">setDefaultWidth</a>(10000);
00180         <a class="code" href="classTabs.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a14">setDefaultHeight</a>(10000);
00181     }
00182     
00183     <a class="code" href="classTabs.html#r2">app</a>-&gt;quit();
00184 }
00185 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Fri Sep 17 18:11:40 2004 for General Ledger by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.8 </small></address>
</body>
</html>
