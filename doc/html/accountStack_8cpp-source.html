<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>General Ledger: accountStack.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.8 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>accountStack.cpp</h1><a href="accountStack_8cpp.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="preprocessor">#include &lt;typeinfo&gt;</span>
00002 
00003 <span class="preprocessor">#include &lt;qwidget.h&gt;</span>
00004 <span class="preprocessor">#include &lt;qvgroupbox.h&gt;</span>
00005 <span class="preprocessor">#include &lt;qlayout.h&gt;</span>
00006 <span class="preprocessor">#include &lt;qpushbutton.h&gt;</span>
00007 <span class="preprocessor">#include &lt;qframe.h&gt;</span>
00008 <span class="preprocessor">#include &lt;qlabel.h&gt;</span>
00009 <span class="preprocessor">#include &lt;qfiledialog.h&gt;</span>
00010 <span class="preprocessor">#include &lt;qevent.h&gt;</span>
00011 
00012 <span class="preprocessor">#include "config.h"</span>
00013 <span class="preprocessor">#include "<a class="code" href="database_8h.html">database.h</a>"</span>
00014 <span class="preprocessor">#include "<a class="code" href="settings_8h.html">settings.h</a>"</span>
00015 <span class="preprocessor">#include "<a class="code" href="accountStack_8h.html">accountStack.h</a>"</span>
00016 <span class="preprocessor">#include "<a class="code" href="accountTable_8h.html">accountTable.h</a>"</span>
00017 <span class="preprocessor">#include "<a class="code" href="goBackLabel_8h.html">goBackLabel.h</a>"</span>
00018 
<a name="l00019"></a><a class="code" href="classAccountStack.html#a0">00019</a> <a class="code" href="classAccountStack.html#a0">AccountStack::AccountStack</a>(QWidget *parent, <span class="keyword">const</span> <span class="keywordtype">char</span> *name)
00020     : QWidget(parent,name)
00021 {
00022     <a class="code" href="classAccountStack.html#r0">db</a> = <a class="code" href="classDatabase.html#e0">Database::instance</a>();
00023     <a class="code" href="classAccountStack.html#r1">settings</a> = <a class="code" href="classSettings.html#e0">Settings::instance</a>();
00024 
00025     <a class="code" href="classAccountStack.html#r2">exportPath</a> = <a class="code" href="classAccountStack.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a3">getExportPath</a>();
00026     <a class="code" href="classAccountStack.html#r3">importPath</a> = <a class="code" href="classAccountStack.html#r1">settings</a>-&gt;<a class="code" href="classSettings.html#a5">getImportPath</a>();
00027 
00028     <a class="code" href="classAccountStack.html#r4">active</a> = <span class="keyword">false</span>;
00029 }
00030 
<a name="l00031"></a><a class="code" href="classAccountStack.html#a1">00031</a> <a class="code" href="classAccountStack.html#a1">AccountStack::~AccountStack</a>()
00032 {}
00033 
<a name="l00034"></a><a class="code" href="classAccountStack.html#k0">00034</a> <span class="keywordtype">void</span> <a class="code" href="classAccountStack.html#k0">AccountStack::dbOpened</a>()
00035 {
00036     <span class="keywordflow">if</span>(<a class="code" href="classAccountStack.html#r4">active</a>)
00037     {
00038         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.exportButton;
00039         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.importButton;
00040         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.bottomRightBoxLayout;
00041         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.bottomRightFrame;
00042         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.bottomLabel;
00043         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.bottomHBoxLayout;
00044         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.bottomWidget;
00045         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.dataTable;
00046         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.topLabel;
00047         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.labelLayout;
00048         <span class="keyword">delete</span> <a class="code" href="classAccountStack.html#r16">main</a>.vBoxLayout;
00049     }
00050     
00051     <a class="code" href="classAccountStack.html#r16">main</a>.vBoxLayout = <span class="keyword">new</span> QVBoxLayout(<span class="keyword">this</span>);
00052     <a class="code" href="classAccountStack.html#r16">main</a>.vBoxLayout-&gt;setMargin(5);
00053     <a class="code" href="classAccountStack.html#r16">main</a>.vBoxLayout-&gt;setSpacing(5);
00054     
00055     <a class="code" href="classAccountStack.html#r16">main</a>.labelLayout = <span class="keyword">new</span> QHBoxLayout(<a class="code" href="classAccountStack.html#r16">main</a>.vBoxLayout);
00056     <a class="code" href="classAccountStack.html#r16">main</a>.topLabel = <span class="keyword">new</span> <a class="code" href="classGoBackLabel.html">GoBackLabel</a>(<span class="keyword">this</span>);
00057     connect(<a class="code" href="classAccountStack.html#r16">main</a>.topLabel, SIGNAL(goBack()), <span class="keyword">this</span>, SIGNAL(<a class="code" href="classAccountStack.html#l0">goToMain</a>()));
00058     <a class="code" href="classAccountStack.html#r16">main</a>.labelLayout-&gt;addWidget(<a class="code" href="classAccountStack.html#r16">main</a>.topLabel);
00059     <a class="code" href="classAccountStack.html#r16">main</a>.labelLayout-&gt;addStretch();
00060     
00061     <a class="code" href="classAccountStack.html#r16">main</a>.dataTable = <span class="keyword">new</span> <a class="code" href="classAccountTable.html">AccountTable</a>(<span class="keyword">this</span>);
00062     connect(<a class="code" href="classAccountStack.html#r16">main</a>.dataTable, SIGNAL(<a class="code" href="classAccountStack.html#l0">goToMain</a>()), <span class="keyword">this</span>, SIGNAL(<a class="code" href="classAccountStack.html#l0">goToMain</a>()));
00063     connect(<a class="code" href="classAccountStack.html#r16">main</a>.dataTable, SIGNAL(<a class="code" href="classAccountStack.html#l1">goToJournal</a>()), <span class="keyword">this</span>, SIGNAL(<a class="code" href="classAccountStack.html#l1">goToJournal</a>()));
00064     connect(<a class="code" href="classAccountStack.html#r16">main</a>.dataTable, SIGNAL(<a class="code" href="classAccountStack.html#l2">goToReports</a>()), <span class="keyword">this</span>, SIGNAL(<a class="code" href="classAccountStack.html#l2">goToReports</a>()));
00065     connect(<a class="code" href="classAccountStack.html#r16">main</a>.dataTable, SIGNAL(<a class="code" href="classAccountStack.html#l3">goToHelp</a>()), <span class="keyword">this</span>, SIGNAL(<a class="code" href="classAccountStack.html#l3">goToHelp</a>()));
00066     <a class="code" href="classAccountStack.html#r16">main</a>.dataTable-&gt;installEventFilter(<span class="keyword">this</span>);
00067     
00068     <a class="code" href="classAccountStack.html#r16">main</a>.vBoxLayout-&gt;addWidget(<a class="code" href="classAccountStack.html#r16">main</a>.dataTable);
00069     
00070     <a class="code" href="classAccountStack.html#r16">main</a>.bottomWidget = <span class="keyword">new</span> QWidget(<span class="keyword">this</span>);
00071     <a class="code" href="classAccountStack.html#r16">main</a>.bottomHBoxLayout = <span class="keyword">new</span> QHBoxLayout(<a class="code" href="classAccountStack.html#r16">main</a>.bottomWidget);
00072     
00073     <a class="code" href="classAccountStack.html#r16">main</a>.bottomLabel = <span class="keyword">new</span> QLabel(
00074             <span class="stringliteral">"&lt;nobr&gt;&lt;b&gt;Keyboard Control:&lt;/b&gt;&lt;/nobr&gt;&lt;br&gt;"</span>
00075             <span class="stringliteral">"&lt;nobr&gt; &amp;nbsp; &amp;nbsp; &lt;b&gt;Enter&lt;/b&gt;: Edit current field, move to next field&lt;/nobr&gt;&lt;br&gt;"</span>
00076             <span class="stringliteral">"&lt;nobr&gt; &amp;nbsp; &amp;nbsp; &lt;b&gt;Insert&lt;/b&gt; / &lt;b&gt;Delete&lt;/b&gt;: Create new entry / Delete selected entry&lt;/nobr&gt;"</span>,
00077             <a class="code" href="classAccountStack.html#r16">main</a>.bottomWidget);
00078     
00079     <a class="code" href="classAccountStack.html#r16">main</a>.bottomRightFrame = <span class="keyword">new</span> QFrame(<a class="code" href="classAccountStack.html#r16">main</a>.bottomWidget);
00080     <a class="code" href="classAccountStack.html#r16">main</a>.bottomRightBoxLayout = <span class="keyword">new</span> QBoxLayout(<a class="code" href="classAccountStack.html#r16">main</a>.bottomRightFrame, QBoxLayout::LeftToRight);
00081     <a class="code" href="classAccountStack.html#r16">main</a>.bottomRightBoxLayout-&gt;setSpacing(5);
00082     
00083     <a class="code" href="classAccountStack.html#r16">main</a>.importButton = <span class="keyword">new</span> QPushButton(
00084             QIconSet( QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/import.png"</span>) ),
00085             <span class="stringliteral">"Import from CSV (F11)"</span>, <a class="code" href="classAccountStack.html#r16">main</a>.bottomRightFrame);
00086     <a class="code" href="classAccountStack.html#r16">main</a>.importButton-&gt;setFocusPolicy(QWidget::NoFocus);
00087     connect(<a class="code" href="classAccountStack.html#r16">main</a>.importButton, SIGNAL(clicked()), <span class="keyword">this</span>, SLOT(<a class="code" href="classAccountStack.html#k1">importCSV</a>()));
00088     
00089     <a class="code" href="classAccountStack.html#r16">main</a>.exportButton = <span class="keyword">new</span> QPushButton(
00090             QIconSet( QPixmap::fromMimeSource(ICON_PATH + <span class="stringliteral">"/export.png"</span>) ),
00091             <span class="stringliteral">"Export to CSV (F12)"</span>, <a class="code" href="classAccountStack.html#r16">main</a>.bottomRightFrame);
00092     <a class="code" href="classAccountStack.html#r16">main</a>.exportButton-&gt;setFocusPolicy(QWidget::NoFocus);
00093     connect(<a class="code" href="classAccountStack.html#r16">main</a>.exportButton, SIGNAL(clicked()), <span class="keyword">this</span>, SLOT(<a class="code" href="classAccountStack.html#k2">exportCSV</a>()));
00094     
00095     <a class="code" href="classAccountStack.html#r16">main</a>.bottomRightBoxLayout-&gt;addWidget(<a class="code" href="classAccountStack.html#r16">main</a>.importButton, 0, Qt::AlignLeft | Qt::AlignTop);
00096     <a class="code" href="classAccountStack.html#r16">main</a>.bottomRightBoxLayout-&gt;addWidget(<a class="code" href="classAccountStack.html#r16">main</a>.exportButton, 0, Qt::AlignLeft | Qt::AlignTop);
00097     
00098     <a class="code" href="classAccountStack.html#r16">main</a>.bottomHBoxLayout-&gt;addWidget(<a class="code" href="classAccountStack.html#r16">main</a>.bottomLabel);
00099     <a class="code" href="classAccountStack.html#r16">main</a>.bottomHBoxLayout-&gt;addStretch();
00100     <a class="code" href="classAccountStack.html#r16">main</a>.bottomHBoxLayout-&gt;addWidget(<a class="code" href="classAccountStack.html#r16">main</a>.bottomRightFrame);
00101     
00102     <a class="code" href="classAccountStack.html#r16">main</a>.vBoxLayout-&gt;addWidget(<a class="code" href="classAccountStack.html#r16">main</a>.bottomWidget);
00103     
00104     <a class="code" href="classAccountStack.html#r4">active</a> = <span class="keyword">true</span>;
00105 }
00106 
<a name="l00107"></a><a class="code" href="classAccountStack.html#k1">00107</a> <span class="keywordtype">void</span> <a class="code" href="classAccountStack.html#k1">AccountStack::importCSV</a>()
00108 {
00109     QString file = QFileDialog::getOpenFileName(
00110             <a class="code" href="classAccountStack.html#r3">importPath</a>,
00111             <span class="stringliteral">"Comma Separated Values (*.csv)"</span>,
00112             <span class="keyword">this</span>,
00113             0,
00114             <span class="stringliteral">"Import Accounts"</span>);
00115     
00116     <span class="keywordflow">if</span>(file != <span class="stringliteral">""</span>)
00117     {
00118         <a class="code" href="classAccountStack.html#r0">db</a>-&gt;<a class="code" href="classDatabase.html#a15">importCSV</a>(<span class="stringliteral">"accounts"</span>, file);
00119         <a class="code" href="classAccountStack.html#r16">main</a>.dataTable-&gt;populate();
00120     }
00121 }
00122 
<a name="l00123"></a><a class="code" href="classAccountStack.html#k2">00123</a> <span class="keywordtype">void</span> <a class="code" href="classAccountStack.html#k2">AccountStack::exportCSV</a>()
00124 {
00125     QString file = QFileDialog::getSaveFileName(
00126             <a class="code" href="classAccountStack.html#r2">exportPath</a>,
00127             <span class="stringliteral">"Comma Separated Values (*.csv)"</span>,
00128             <span class="keyword">this</span>,
00129             0,
00130             <span class="stringliteral">"Export Accounts"</span>);
00131 
00132     <span class="keywordflow">if</span>(file != <span class="stringliteral">""</span>)
00133         <a class="code" href="classAccountStack.html#r0">db</a>-&gt;<a class="code" href="classDatabase.html#a14">exportCSV</a>(<span class="stringliteral">"accounts"</span>, file);
00134 }
00135 
<a name="l00136"></a><a class="code" href="classAccountStack.html#d0">00136</a> <span class="keywordtype">bool</span> <a class="code" href="classAccountStack.html#d0">AccountStack::eventFilter</a>(QObject *target, QEvent *event)
00137 {
00138     <span class="keywordflow">if</span>(event-&gt;type() == QEvent::KeyPress)
00139     {
00140         QKeyEvent *keyEvent = (QKeyEvent*)event;
00141         <span class="keywordflow">if</span>(keyEvent-&gt;key() == Key_F11)
00142         {
00143             <a class="code" href="classAccountStack.html#k1">importCSV</a>();
00144             <span class="keywordflow">return</span> <span class="keyword">true</span>;
00145         }
00146         <span class="keywordflow">if</span>(keyEvent-&gt;key() == Key_F12)
00147         {
00148             <a class="code" href="classAccountStack.html#k2">exportCSV</a>();
00149             <span class="keywordflow">return</span> <span class="keyword">true</span>;
00150         }
00151     }
00152     
00153     <span class="keywordflow">return</span> QWidget::eventFilter(target,event);
00154 }  
00155 
<a name="l00156"></a><a class="code" href="classAccountStack.html#d1">00156</a> <span class="keywordtype">void</span> <a class="code" href="classAccountStack.html#d1">AccountStack::showEvent</a>(QShowEvent*)
00157 {
00158     <a class="code" href="classAccountStack.html#r16">main</a>.dataTable-&gt;setFocus();
00159 }
00160 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Fri Sep 17 18:11:38 2004 for General Ledger by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.8 </small></address>
</body>
</html>
